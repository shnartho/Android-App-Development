!function(e){var t;"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).braintree||(t.braintree={})).client=e()}(function(){return function n(i,o,a){function s(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=o[t]={exports:{}},i[t][0].call(r.exports,function(e){return s(i[t][1][e]||e)},r,r.exports,n,i,o,a)}return o[t].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(r,"__esModule",{value:!0}),r.PromiseGlobal=void 0,e=n(e("promise-polyfill")),e="undefined"!=typeof Promise?Promise:e["default"],r.PromiseGlobal=e},{"promise-polyfill":15}],2:[function(e,t,r){"use strict";var a=e("./lib/promise"),s={};function n(r){var e,t=JSON.stringify(r);if(!r.forceScriptReload&&(e=s[t]))return e;var n=document.createElement("script"),i=r.dataAttributes||{},o=r.container||document.head;return n.src=r.src,n.id=r.id||"",n["async"]=!0,r.crossorigin&&n.setAttribute("crossorigin",""+r.crossorigin),Object.keys(i).forEach(function(e){n.setAttribute("data-"+e,""+i[e])}),e=new a.PromiseGlobal(function(e,t){n.addEventListener("load",function(){e(n)}),n.addEventListener("error",function(){t(new Error(r.src+" failed to load."))}),n.addEventListener("abort",function(){t(new Error(r.src+" has aborted."))}),o.appendChild(n)}),s[t]=e}n.clearCache=function(){s={}},t.exports=n},{"./lib/promise":1}],3:[function(e,t,r){t.exports=e("./dist/load-script")},{"./dist/load-script":2}],4:[function(e,t,r){"use strict";var n=e("./is-ie11");t.exports=function(e){return-1!==(e=e||window.navigator.userAgent).indexOf("MSIE")||n(e)}},{"./is-ie11":5}],5:[function(e,t,r){"use strict";t.exports=function(e){return-1!==(e=e||window.navigator.userAgent).indexOf("Trident/7")}},{}],6:[function(e,t,r){"use strict";t.exports=function(e){return-1!==(e=e||window.navigator.userAgent).indexOf("MSIE 9")}},{}],7:[function(e,t,r){t.exports=e("./dist/is-ie")},{"./dist/is-ie":4}],8:[function(e,t,r){t.exports=e("./dist/is-ie9")},{"./dist/is-ie9":6}],9:[function(e,t,r){"use strict";var n="undefined"!=typeof Promise?Promise:null,n=(i.defaultOnResolve=function(e){return i.Promise.resolve(e)},i.defaultOnReject=function(e){return i.Promise.reject(e)},i.setPromise=function(e){i.Promise=e},i.shouldCatchExceptions=function(e){return e.hasOwnProperty("suppressUnhandledPromiseMessage")?Boolean(e.suppressUnhandledPromiseMessage):Boolean(i.suppressUnhandledPromiseMessage)},i.all=function(e){return i.Promise.all(e)},i.allSettled=function(e){return i.Promise.allSettled(e)},i.race=function(e){return i.Promise.race(e)},i.reject=function(e){return i.Promise.reject(e)},i.resolve=function(e){return i.Promise.resolve(e)},i.prototype.then=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this._promise).then.apply(e,t)},i.prototype["catch"]=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this._promise)["catch"].apply(e,t)},i.prototype.resolve=function(e){var t=this;return this.isFulfilled||(this._setResolved(),i.Promise.resolve().then(function(){return t._onResolve(e)}).then(function(e){t._resolveFunction(e)})["catch"](function(e){t._resetState(),t.reject(e)})),this},i.prototype.reject=function(e){var t=this;return this.isFulfilled||(this._setRejected(),i.Promise.resolve().then(function(){return t._onReject(e)}).then(function(e){t._setResolved(),t._resolveFunction(e)})["catch"](function(e){return t._rejectFunction(e)})),this},i.prototype._resetState=function(){this.isFulfilled=!1,this.isResolved=!1,this.isRejected=!1},i.prototype._setResolved=function(){this.isFulfilled=!0,this.isResolved=!0,this.isRejected=!1},i.prototype._setRejected=function(){this.isFulfilled=!0,this.isResolved=!1,this.isRejected=!0},i.Promise=n,i);function i(e){var r=this;"function"!=typeof e?(this._promise=new i.Promise(function(e,t){r._resolveFunction=e,r._rejectFunction=t}),this._onResolve=(e=e||{}).onResolve||i.defaultOnResolve,this._onReject=e.onReject||i.defaultOnReject,i.shouldCatchExceptions(e)&&this._promise["catch"](function(){}),this._resetState()):this._promise=new i.Promise(e)}t.exports=n},{}],10:[function(e,t,r){"use strict";t.exports=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deferred=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];setTimeout(function(){try{r.apply(void 0,e)}catch(e){console.log("Error in callback function"),console.log(e)}},1)}}},{}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.once=function(r){var n=!1;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n||(n=!0,r.apply(void 0,e))}}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.promiseOrCallback=function(e,t){if(!t)return e;e.then(function(e){return t(null,e)})["catch"](function(e){return t(e)})}},{}],14:[function(e,t,r){"use strict";var i=e("./lib/deferred"),o=e("./lib/once"),a=e("./lib/promise-or-callback");function s(n){return function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return"function"==typeof t[t.length-1]&&(e=t.pop(),e=o.once(i.deferred(e))),a.promiseOrCallback(n.apply(this,t),e)}}s.wrapPrototype=function(n,e){var i=(e=void 0===e?{}:e).ignoreMethods||[],o=!0===e.transformPrivateMethods;return Object.getOwnPropertyNames(n.prototype).filter(function(e){var t="constructor"!==e&&"function"==typeof n.prototype[e],r=-1===i.indexOf(e),e=o||"_"!==e.charAt(0);return t&&e&&r}).forEach(function(e){var t=n.prototype[e];n.prototype[e]=s(t)}),n},t.exports=s},{"./lib/deferred":11,"./lib/once":12,"./lib/promise-or-callback":13}],15:[function(e,t,r){"use strict";var n=setTimeout;function c(e){return Boolean(e&&void 0!==e.length)}function i(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function a(r,n){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,o._immediateFn(function(){var e,t=1===r._state?n.onFulfilled:n.onRejected;if(null!==t){try{e=t(r._value)}catch(e){return void u(n.promise,e)}s(n.promise,e)}else(1===r._state?s:u)(n.promise,r._value)})):r._deferreds.push(n)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if(e instanceof o)return t._state=3,t._value=e,void d(t);if("function"==typeof r)return void l((n=r,i=e,function(){n.apply(i,arguments)}),t)}t._state=1,t._value=e,d(t)}catch(e){u(t,e)}var n,i}function u(e,t){e._state=2,e._value=t,d(e)}function d(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,r=e._deferreds.length;t<r;t++)a(e,e._deferreds[t]);e._deferreds=null}function p(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function l(e,t){var r=!1;try{e(function(e){r||(r=!0,s(t,e))},function(e){r||(r=!0,u(t,e))})}catch(e){if(r)return;r=!0,u(t,e)}}o.prototype["catch"]=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var r=new this.constructor(i);return a(this,new p(e,t,r)),r},o.prototype["finally"]=function(t){var r=this.constructor;return this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){return r.reject(e)})})},o.all=function(t){return new o(function(i,o){if(!c(t))return o(new TypeError("Promise.all accepts an array"));var a=Array.prototype.slice.call(t);if(0===a.length)return i([]);for(var s=a.length,e=0;e<a.length;e++)!function t(r,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){t(r,e)},o)}a[r]=e,0==--s&&i(a)}catch(e){o(e)}}(e,a[e])})},o.allSettled=function(r){return new this(function(i,e){if(!r||void 0===r.length)return e(new TypeError(typeof r+" "+r+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var o=Array.prototype.slice.call(r);if(0===o.length)return i([]);for(var a=o.length,t=0;t<o.length;t++)!function t(r,e){if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){t(r,e)},function(e){o[r]={status:"rejected",reason:e},0==--a&&i(o)})}o[r]={status:"fulfilled",value:e},0==--a&&i(o)}(t,o[t])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(r){return new o(function(e,t){t(r)})},o.race=function(i){return new o(function(e,t){if(!c(i))return t(new TypeError("Promise.race accepts an array"));for(var r=0,n=i.length;r<n;r++)o.resolve(i[r]).then(e,t)})},o._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){n(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t.exports=o},{}],16:[function(e,t,r){"use strict";var n=e("@braintree/browser-detection/is-ie"),e=e("@braintree/browser-detection/is-ie9");t.exports={isIe:n,isIe9:e}},{"@braintree/browser-detection/is-ie":7,"@braintree/browser-detection/is-ie9":8}],17:[function(e,t,r){"use strict";var u=e("./constants").BRAINTREE_VERSION,n=e("./request/graphql"),i=e("./request"),o=e("../lib/is-verified-domain"),d=e("../lib/braintree-error"),p=e("../lib/convert-to-braintree-error"),a=e("./get-configuration").getConfiguration,s=e("../lib/create-authorization-data"),l=e("../lib/add-metadata"),f=e("../lib/promise"),c=e("@braintree/wrap-promise"),h=e("../lib/once"),y=e("../lib/deferred"),E=e("../lib/assign").assign,g=e("../lib/analytics"),I=e("./errors"),m=e("../lib/constants").VERSION,_=e("../lib/constants").GRAPHQL_URLS,T=e("../lib/methods"),A=e("../lib/convert-methods-to-error"),N=e("../lib/assets"),R=e("../lib/constants").FRAUDNET_FNCLS,v=e("../lib/constants").FRAUDNET_SOURCE,b=e("../lib/constants").FRAUDNET_URL,C={};function O(e){var t,r;if(e=e||{},t=JSON.stringify(e),!(r=e.gatewayConfiguration))throw new d(I.CLIENT_MISSING_GATEWAY_CONFIGURATION);["assetsUrl","clientApiUrl","configUrl"].forEach(function(e){if(e in r&&!o(r[e]))throw new d({type:I.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.type,code:I.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.code,message:e+" property is on an invalid domain."})}),this.getConfiguration=function(){return JSON.parse(t)},this._request=i,this._configuration=this.getConfiguration(),this._clientApiBaseUrl=r.clientApiUrl+"/v1/",r.graphQL&&(this._graphQL=new n({graphQL:r.graphQL}))}O.initialize=function(t){var r,e,n=C[t.authorization];if(n)return g.sendEvent(n,"custom.client.load.cached"),n;try{e=s(t.authorization)}catch(e){return f.reject(new d(I.CLIENT_INVALID_AUTHORIZATION))}return n=a(e).then(function(e){return t.debug&&(e.isDebug=!0),e.authorization=t.authorization,r=new O(e)}),C[t.authorization]=n,g.sendEvent(n,"custom.client.load.initialized"),n.then(function(e){return g.sendEvent(r,"custom.client.load.succeeded"),e})["catch"](function(e){return delete C[t.authorization],f.reject(e)})},O.clearCache=function(){C={}},O.prototype._findOrCreateFraudnetJSON=function(e){var t,r,n=document.querySelector('script[fncls="'+R+'"]');n||((n=document.body.appendChild(document.createElement("script"))).type="application/json",n.setAttribute("fncls",R)),r=this.getConfiguration(),t={rda_tenant:"bt_card",mid:r.gatewayConfiguration.merchantId},(r=r.authorizationFingerprint)&&r.split("&").forEach(function(e){"customer_id"===(e=e.split("="))[0]&&1<e.length&&(t.cid=e[1])}),e={f:e.substr(0,32),fp:t,bu:!1,s:v},n.text=JSON.stringify(e)},O.prototype.request=function(s,r){var c=this,e=new f(function(n,i){var o,e,t,r,a=Boolean("payment_methods/credit_cards"===s.endpoint&&c.getConfiguration().gatewayConfiguration.creditCards.collectDeviceData);if("graphQLApi"!==s.api&&(s.method?s.endpoint||(r="options.endpoint"):r="options.method"),r)throw new d({type:I.CLIENT_OPTION_REQUIRED.type,code:I.CLIENT_OPTION_REQUIRED.code,message:r+" is required when making a request."});if(o="api"in s?s.api:"clientApi",t={method:s.method,graphQL:c._graphQL,timeout:s.timeout,metadata:c._configuration.analyticsMetadata},"clientApi"===o)e=c._clientApiBaseUrl,t.data=l(c._configuration,s.data);else{if("graphQLApi"!==o)throw new d({type:I.CLIENT_OPTION_INVALID.type,code:I.CLIENT_OPTION_INVALID.code,message:"options.api is invalid."});e=_[c._configuration.gatewayConfiguration.environment],s.endpoint="",t.method="post",t.data=E({clientSdkMetadata:{platform:c._configuration.analyticsMetadata.platform,source:c._configuration.analyticsMetadata.source,integration:c._configuration.analyticsMetadata.integration,sessionId:c._configuration.analyticsMetadata.sessionId,version:m}},s.data),t.headers={Authorization:"Bearer "+((r=c._configuration).authorizationFingerprint||r.authorization),"Braintree-Version":u}}t.url=e+s.endpoint,t.sendAnalyticsEvent=function(e){g.sendEvent(c,e)},c._request(t,function(e,t,r){(e=function(e,t){var r;if(-1===e?r=new d(I.CLIENT_REQUEST_TIMEOUT):401===e?r=new d(I.CLIENT_AUTHORIZATION_INVALID):403===e?r=new d(I.CLIENT_AUTHORIZATION_INSUFFICIENT):429===e?r=new d(I.CLIENT_RATE_LIMITED):500<=e?r=new d(I.CLIENT_GATEWAY_NETWORK):(e<200||400<=e)&&(r=p(t,{type:I.CLIENT_REQUEST_ERROR.type,code:I.CLIENT_REQUEST_ERROR.code,message:I.CLIENT_REQUEST_ERROR.message})),r)return r.details=r.details||{},r.details.httpStatus=e,r}(r,e))?i(e):"graphQLApi"===o&&t.errors?i(p(t.errors,{type:I.CLIENT_GRAPHQL_REQUEST_ERROR.type,code:I.CLIENT_GRAPHQL_REQUEST_ERROR.code,message:I.CLIENT_GRAPHQL_REQUEST_ERROR.message})):(t=E({_httpStatus:r},t),a&&t.creditCards&&0<t.creditCards.length&&(c._findOrCreateFraudnetJSON(t.creditCards[0].nonce),N.loadScript({src:b,forceScriptReload:!0})),n(t))})});return"function"==typeof r?(r=h(y(r)),void e.then(function(e){r(null,e,e._httpStatus)})["catch"](function(e){var t=e&&e.details&&e.details.httpStatus;r(e,null,t)})):e},O.prototype.toJSON=function(){return this.getConfiguration()},O.prototype.getVersion=function(){return m},O.prototype.teardown=c(function(){return delete C[this.getConfiguration().authorization],A(this,T(O.prototype)),f.resolve()}),t.exports=O},{"../lib/add-metadata":38,"../lib/analytics":39,"../lib/assets":40,"../lib/assign":41,"../lib/braintree-error":42,"../lib/constants":43,"../lib/convert-methods-to-error":44,"../lib/convert-to-braintree-error":45,"../lib/create-authorization-data":46,"../lib/deferred":47,"../lib/is-verified-domain":51,"../lib/methods":53,"../lib/once":54,"../lib/promise":55,"./constants":18,"./errors":19,"./get-configuration":20,"./request":32,"./request/graphql":30,"@braintree/wrap-promise":14}],18:[function(e,t,r){"use strict";t.exports={BRAINTREE_VERSION:"2018-05-10"}},{}],19:[function(e,t,r){"use strict";e=e("../lib/braintree-error"),t.exports={CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN:{type:e.types.MERCHANT,code:"CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN"},CLIENT_OPTION_REQUIRED:{type:e.types.MERCHANT,code:"CLIENT_OPTION_REQUIRED"},CLIENT_OPTION_INVALID:{type:e.types.MERCHANT,code:"CLIENT_OPTION_INVALID"},CLIENT_MISSING_GATEWAY_CONFIGURATION:{type:e.types.INTERNAL,code:"CLIENT_MISSING_GATEWAY_CONFIGURATION",message:"Missing gatewayConfiguration."},CLIENT_INVALID_AUTHORIZATION:{type:e.types.MERCHANT,code:"CLIENT_INVALID_AUTHORIZATION",message:"Authorization is invalid. Make sure your client token or tokenization key is valid."},CLIENT_GATEWAY_NETWORK:{type:e.types.NETWORK,code:"CLIENT_GATEWAY_NETWORK",message:"Cannot contact the gateway at this time."},CLIENT_REQUEST_TIMEOUT:{type:e.types.NETWORK,code:"CLIENT_REQUEST_TIMEOUT",message:"Request timed out waiting for a reply."},CLIENT_REQUEST_ERROR:{type:e.types.NETWORK,code:"CLIENT_REQUEST_ERROR",message:"There was a problem with your request."},CLIENT_GRAPHQL_REQUEST_ERROR:{type:e.types.NETWORK,code:"CLIENT_GRAPHQL_REQUEST_ERROR",message:"There was a problem with your request."},CLIENT_RATE_LIMITED:{type:e.types.MERCHANT,code:"CLIENT_RATE_LIMITED",message:"You are being rate-limited; please try again in a few minutes."},CLIENT_AUTHORIZATION_INSUFFICIENT:{type:e.types.MERCHANT,code:"CLIENT_AUTHORIZATION_INSUFFICIENT",message:"The authorization used has insufficient privileges."},CLIENT_AUTHORIZATION_INVALID:{type:e.types.MERCHANT,code:"CLIENT_AUTHORIZATION_INVALID",message:"Either the client token has expired and a new one should be generated or the tokenization key has been deactivated or deleted."}}},{"../lib/braintree-error":42}],20:[function(e,t,r){"use strict";var c=e("../lib/braintree-error"),n=e("../lib/promise"),i=e("@braintree/wrap-promise"),u=e("./request"),d=e("@braintree/uuid"),p=e("../lib/constants"),l=e("./errors"),f=e("./request/graphql"),h=e("../lib/constants").GRAPHQL_URLS,y=e("../lib/is-date-string-before-or-on"),E=e("./constants").BRAINTREE_VERSION;t.exports={getConfiguration:i(function(t){return new n(function(n,i){var o,e=d(),a={merchantAppId:window.location.host,platform:p.PLATFORM,sdkVersion:p.VERSION,source:p.SOURCE,integration:p.INTEGRATION,integrationType:p.INTEGRATION,sessionId:e},s=t.attrs,e=t.configUrl;s._meta=a,s.braintreeLibraryVersion=p.BRAINTREE_LIBRARY_VERSION,s.configVersion="3",e={url:e,method:"GET",data:s},s.authorizationFingerprint&&t.graphQL?(y(t.graphQL.date,E)&&(e.graphQL=new f({graphQL:{url:t.graphQL.url,features:["configuration"]}})),e.metadata=a):s.tokenizationKey&&(e.graphQL=new f({graphQL:{url:h[t.environment],features:["configuration"]}}),e.metadata=a),u(e,function(e,t,r){return e?(r=403===r?l.CLIENT_AUTHORIZATION_INSUFFICIENT:401===r?l.CLIENT_AUTHORIZATION_INVALID:l.CLIENT_GATEWAY_NETWORK,void i(new c({type:r.type,code:r.code,message:r.message,details:{originalError:e}}))):(o={authorizationType:s.tokenizationKey?"TOKENIZATION_KEY":"CLIENT_TOKEN",authorizationFingerprint:s.authorizationFingerprint,analyticsMetadata:a,gatewayConfiguration:t},void n(o))})})})}},{"../lib/braintree-error":42,"../lib/constants":43,"../lib/is-date-string-before-or-on":50,"../lib/promise":55,"./constants":18,"./errors":19,"./request":32,"./request/graphql":30,"@braintree/uuid":10,"@braintree/wrap-promise":14}],21:[function(e,t,r){"use strict";var n=e("../lib/braintree-error"),i=e("./client"),o=e("../lib/promise"),a=e("@braintree/wrap-promise"),s=e("../lib/errors");t.exports={create:a(function(e){return e.authorization?i.initialize(e):o.reject(new n({type:s.INSTANTIATION_OPTION_REQUIRED.type,code:s.INSTANTIATION_OPTION_REQUIRED.code,message:"options.authorization is required when instantiating a client."}))}),VERSION:"3.82.0"}},{"../lib/braintree-error":42,"../lib/errors":49,"../lib/promise":55,"./client":17,"@braintree/wrap-promise":14}],22:[function(e,t,r){"use strict";var y=e("../../lib/querystring"),E=e("../../lib/assign").assign,g=e("./prep-body"),I=e("./parse-body"),m=e("./xhr"),_=m.isAvailable,T=e("./graphql/request"),A=e("./default-request");function v(t,r,n){var i,o,a,e,s,c,u=t.url,d=t.graphQL,p=t.timeout,l=m.getRequestObject(),f=n,h=Boolean(d&&d.isGraphQLRequest(u,t.data));t.headers=E({"Content-Type":"application/json"},t.headers),u=(a=new(h?T:A)(t)).getUrl(),e=a.getBody(),d=a.getMethod(),s=a.getHeaders(),"GET"===d&&(u=y.queryify(u,e),e=null),_?l.onreadystatechange=function(){if(4===l.readyState){if(0===l.status&&h)return delete t.graphQL,void v(t,r,n);if(c=I(l.responseText),o=a.adaptResponseBody(c),400<=(i=a.determineStatus(l.status,c))||i<200){if(h&&("UNKNOWN"===(e=!(e=c).data&&e.errors&&e.errors[0]&&e.errors[0].extensions&&e.errors[0].extensions.errorClass)||"INTERNAL"===e))return delete t.graphQL,void v(t,r,n);r<1&&(!(e=i)||408===e)?v(t,++r,n):f(o||"error",null,i||500)}else f(null,o,i);var e}}:(t.headers&&(u=y.queryify(u,s)),l.onload=function(){f(null,I(l.responseText),l.status)},l.onerror=function(){f("error",null,500)},l.onprogress=function(){},l.ontimeout=function(){f("timeout",null,-1)});try{l.open(d,u,!0)}catch(e){if(!h)throw e;return delete t.graphQL,void v(t,r,n)}l.timeout=p,_&&Object.keys(s).forEach(function(e){l.setRequestHeader(e,s[e])});try{l.send(g(d,e))}catch(e){}}t.exports={request:function(e,t){v(e,0,t)}}},{"../../lib/assign":41,"../../lib/querystring":56,"./default-request":23,"./graphql/request":31,"./parse-body":35,"./prep-body":36,"./xhr":37}],23:[function(e,t,r){"use strict";function n(e){this._url=e.url,this._data=e.data,this._method=e.method,this._headers=e.headers}n.prototype.getUrl=function(){return this._url},n.prototype.getBody=function(){return this._data},n.prototype.getMethod=function(){return this._method},n.prototype.getHeaders=function(){return this._headers},n.prototype.adaptResponseBody=function(e){return e},n.prototype.determineStatus=function(e){return e},t.exports=n},{}],24:[function(e,t,r){"use strict";t.exports=function(){return window.navigator.userAgent}},{}],25:[function(e,t,r){"use strict";var n=e("./error"),i=e("../../../../lib/assign").assign,o_creditCard={AMERICAN_EXPRESS:"American Express",DISCOVER:"Discover",INTERNATIONAL_MAESTRO:"Maestro",JCB:"JCB",MASTERCARD:"MasterCard",SOLO:"Solo",UK_MAESTRO:"UK Maestro",UNION_PAY:"UnionPay",VISA:"Visa"},o_applePayWeb={VISA:"visa",MASTERCARD:"mastercard",DISCOVER:"discover",AMERICAN_EXPRESS:"amex",INTERNATIONAL_MAESTRO:"maestro",ELO:"elo"},o_visaCheckout={VISA:"Visa",MASTERCARD:"MasterCard",DISCOVER:"Discover",AMERICAN_EXPRESS:"American Express"},o_googlePay={VISA:"visa",MASTERCARD:"mastercard",DISCOVER:"discover",AMERICAN_EXPRESS:"amex",INTERNATIONAL_MAESTRO:"maestro",ELO:"elo"},o_masterpass={VISA:"visa",MASTERCARD:"master",DISCOVER:"discover",AMERICAN_EXPRESS:"amex",DINERS:"diners",INTERNATIONAL_MAESTRO:"maestro",JCB:"jcb"};function a(e,r){return e.reduce(function(e,t){return r.hasOwnProperty(t)?e.concat(r[t]):e},[])}t.exports=function(e,t){return e.data&&!e.errors?function(e,t){var r=e.data.clientConfiguration;return e={environment:r.environment.toLowerCase(),clientApiUrl:r.clientApiUrl,assetsUrl:r.assetsUrl,analytics:{url:r.analyticsUrl},merchantId:r.merchantId,venmo:"off"},r.supportedFeatures&&(e.graphQL={url:t._graphQL._config.url,features:r.supportedFeatures.map(function(e){return e.toLowerCase()})}),r.braintreeApi&&(e.braintreeApi=r.braintreeApi),r.applePayWeb&&(e.applePayWeb=r.applePayWeb,e.applePayWeb.supportedNetworks=a(r.applePayWeb.supportedCardBrands,o_applePayWeb),delete e.applePayWeb.supportedCardBrands),r.ideal&&(e.ideal=r.ideal),r.kount&&(e.kount={kountMerchantId:r.kount.merchantId}),r.creditCard?(e.challenges=r.creditCard.challenges.map(function(e){return e.toLowerCase()}),e.creditCards={supportedCardTypes:a(r.creditCard.supportedCardBrands,o_creditCard)},e.threeDSecureEnabled=r.creditCard.threeDSecureEnabled,e.threeDSecure=r.creditCard.threeDSecure):(e.challenges=[],e.creditCards={supportedCardTypes:[]},e.threeDSecureEnabled=!1),r.googlePay&&(e.androidPay={displayName:r.googlePay.displayName,enabled:!0,environment:r.googlePay.environment.toLowerCase(),googleAuthorizationFingerprint:r.googlePay.googleAuthorization,paypalClientId:r.googlePay.paypalClientId,supportedNetworks:a(r.googlePay.supportedCardBrands,o_googlePay)}),r.venmo&&(e.payWithVenmo={merchantId:r.venmo.merchantId,accessToken:r.venmo.accessToken,environment:r.venmo.environment.toLowerCase()}),r.paypal?(e.paypalEnabled=!0,e.paypal=i({},r.paypal),e.paypal.currencyIsoCode=e.paypal.currencyCode,e.paypal.environment=e.paypal.environment.toLowerCase(),delete e.paypal.currencyCode):e.paypalEnabled=!1,r.unionPay&&(e.unionPay={enabled:!0,merchantAccountId:r.unionPay.merchantAccountId}),r.visaCheckout&&(e.visaCheckout={apikey:r.visaCheckout.apiKey,encryptionKey:r.visaCheckout.encryptionKey,externalClientId:r.visaCheckout.externalClientId,supportedCardTypes:a(r.visaCheckout.supportedCardBrands,o_visaCheckout)}),r.masterpass&&(e.masterpass={merchantCheckoutId:r.masterpass.merchantCheckoutId,supportedNetworks:a(r.masterpass.supportedCardBrands,o_masterpass)}),r.usBankAccount&&(e.usBankAccount={routeId:r.usBankAccount.routeId,plaid:{publicKey:r.usBankAccount.plaidPublicKey}}),e}(e,t):n(e)}},{"../../../../lib/assign":41,"./error":27}],26:[function(e,t,r){"use strict";var n=e("./error"),i={AMERICAN_EXPRESS:"American Express",DINERS:"Discover",DISCOVER:"Discover",INTERNATIONAL_MAESTRO:"Maestro",JCB:"JCB",MASTERCARD:"MasterCard",UK_MAESTRO:"Maestro",UNION_PAY:"Union Pay",VISA:"Visa"},o={YES:"Yes",NO:"No",UNKNOWN:"Unknown"},a={PSDTWO:"psd2"};t.exports=function(e){return(e.data&&!e.errors?function(e){var t=e.data.tokenizeCreditCard,r=t.creditCard,e=r.last4?r.last4.substr(2,4):"",n=r.binData;return n&&(["commercial","debit","durbinRegulated","healthcare","payroll","prepaid"].forEach(function(e){n[e]?n[e]=o[n[e]]:n[e]="Unknown"}),["issuingBank","countryOfIssuance","productId"].forEach(function(e){n[e]||(n[e]="Unknown")})),e={creditCards:[{binData:n,consumed:!1,description:e?"ending in "+e:"",nonce:t.token,details:{cardholderName:r.cardholderName,expirationMonth:r.expirationMonth,expirationYear:r.expirationYear,bin:r.bin||"",cardType:i[r.brandCode]||"Unknown",lastFour:r.last4||"",lastTwo:e},type:"CreditCard",threeDSecureInfo:null}]},t.authenticationInsight&&(t=t.authenticationInsight.customerAuthenticationRegulationEnvironment,e.creditCards[0].authenticationInsight={regulationEnvironment:a[t]||t.toLowerCase()}),e}:n)(e)}},{"./error":27}],27:[function(e,t,r){"use strict";t.exports=function(e){var t,r,n=e.errors&&e.errors[0]&&e.errors[0].extensions&&e.errors[0].extensions.errorClass;return"VALIDATION"===n?0!==(r=function(e){var t=[];return e.forEach(function(e){e.extensions&&e.extensions.inputPath&&!function e(t,r,n){var i,o=r.extensions.legacyCode,a=t[0];1!==t.length?(n.forEach(function(e){e.field===a&&(i=e)}),i||(i={field:a,fieldErrors:[]},n.push(i)),e(t.slice(1),r,i.fieldErrors)):n.push({code:o,field:a,message:r.message})}(e.extensions.inputPath.slice(1),e,t)}),t}((t=e).errors)).length?{error:{message:{creditCard:"Credit card is invalid"}[r[0].field]},fieldErrors:r}:{error:{message:t.errors[0].message}}:n?{error:{message:e.errors[0].message},fieldErrors:[]}:{error:{message:"There was a problem serving your request"},fieldErrors:[]}}},{}],28:[function(e,t,r){"use strict";t.exports=function(){return{query:"query ClientConfiguration {   clientConfiguration {     analyticsUrl     environment     merchantId     assetsUrl     clientApiUrl     creditCard {       supportedCardBrands       challenges       threeDSecureEnabled       threeDSecure {         cardinalAuthenticationJWT       }     }     applePayWeb {       countryCode       currencyCode       merchantIdentifier       supportedCardBrands     }     googlePay {       displayName       supportedCardBrands       environment       googleAuthorization       paypalClientId     }     ideal {       routeId       assetsUrl     }     kount {       merchantId     }     masterpass {       merchantCheckoutId       supportedCardBrands     }     paypal {       displayName       clientId       privacyUrl       userAgreementUrl       assetsUrl       environment       environmentNoNetwork       unvettedMerchant       braintreeClientId       billingAgreementsEnabled       merchantAccountId       currencyCode       payeeEmail     }     unionPay {       merchantAccountId     }     usBankAccount {       routeId       plaidPublicKey     }     venmo {       merchantId       accessToken       environment     }     visaCheckout {       apiKey       externalClientId       supportedCardBrands     }     braintreeApi {       accessToken       url     }     supportedFeatures   } }",operationName:"ClientConfiguration"}}},{}],29:[function(e,t,r){"use strict";var a=e("../../../../lib/assign").assign;t.exports=function(e){var t,r,n={hasAuthenticationInsight:Boolean(e.authenticationInsight&&e.merchantAccountId)};return{query:(r=(t=n).hasAuthenticationInsight,t="mutation TokenizeCreditCard($input: TokenizeCreditCardInput!",r&&(t+=", $authenticationInsightInput: AuthenticationInsightInput!"),t+=") {   tokenizeCreditCard(input: $input) {     token     creditCard {       bin       brandCode       last4       cardholderName       expirationMonth      expirationYear      binData {         prepaid         healthcare         debit         durbinRegulated         commercial         payroll         issuingBank         countryOfIssuance         productId       }     } ",r&&(t+="    authenticationInsight(input: $authenticationInsightInput) {      customerAuthenticationRegulationEnvironment    }"),t+="  } }"),variables:function(e,t){var n=(r=e.creditCard)&&r.billingAddress,i=r&&r.expirationDate,o=r&&(r.expirationMonth||i&&i.split("/")[0].trim()),i=r&&(r.expirationYear||i&&i.split("/")[1].trim()),r={input:{creditCard:{number:r&&r.number,expirationMonth:o,expirationYear:i,cvv:r&&r.cvv,cardholderName:r&&r.cardholderName},options:{}}};return t.hasAuthenticationInsight&&(r.authenticationInsightInput={merchantAccountId:e.merchantAccountId}),n&&(r.input.creditCard.billingAddress=n),r.input=function(e,t){var r;return e.creditCard&&e.creditCard.options&&"boolean"==typeof e.creditCard.options.validate?r=e.creditCard.options.validate:e.authorizationFingerprint&&e.tokenizationKey||e.authorizationFingerprint?r=!0:e.tokenizationKey&&(r=!1),"boolean"==typeof r&&(t.options=a({validate:r},t.options)),t}(e,r.input),r}(e,n),operationName:"TokenizeCreditCard"}}},{"../../../../lib/assign":41}],30:[function(e,t,r){"use strict";var i=e("../../browser-detection"),o={tokenize_credit_cards:"payment_methods/credit_cards",configuration:"configuration"},a=["creditCard.options.unionPayEnrollment"];function n(e){this._config=e.graphQL}n.prototype.getGraphQLEndpoint=function(){return this._config.url},n.prototype.isGraphQLRequest=function(e,t){var r,n=this.getClientApiPath(e);return!(!this._isGraphQLEnabled()||!n||i.isIe9())&&(e=this._config.features.some(function(e){return o[e]===n}),r=t,!a.some(function(e){return void 0!==e.split(".").reduce(function(e,t){return e&&e[t]},r)})&&e)},n.prototype.getClientApiPath=function(e){var t;return 1<(e=e.split("/client_api/v1/")).length?e[1].split("?")[0]:t},n.prototype._isGraphQLEnabled=function(){return Boolean(this._config)},t.exports=n},{"../../browser-detection":16}],31:[function(e,t,r){"use strict";var n=e("../../constants").BRAINTREE_VERSION,i=e("../../../lib/assign").assign,o=e("./generators/credit-card-tokenization"),a=e("./adapters/credit-card-tokenization"),s=e("./generators/configuration"),e=e("./adapters/configuration"),c={"payment_methods/credit_cards":o,configuration:s},u={"payment_methods/credit_cards":a,configuration:e};function d(e){var t=e.graphQL.getClientApiPath(e.url);this._graphQL=e.graphQL,this._data=e.data,this._method=e.method,this._headers=e.headers,this._clientSdkMetadata={source:e.metadata.source,integration:e.metadata.integration,sessionId:e.metadata.sessionId},this._sendAnalyticsEvent=e.sendAnalyticsEvent||Function.prototype,this._generator=c[t],this._adapter=u[t],this._sendAnalyticsEvent("graphql.init")}d.prototype.getUrl=function(){return this._graphQL.getGraphQLEndpoint()},d.prototype.getBody=function(){var e=function r(n){var i={};return Object.keys(n).forEach(function(e){var t=function(e){return-1===e.indexOf("_")?e:e.toLowerCase().replace(/(\_\w)/g,function(e){return e[1].toUpperCase()})}(e);"object"==typeof n[e]?i[t]=r(n[e]):"number"==typeof n[e]?i[t]=String(n[e]):i[t]=n[e]}),i}(this._data),e=this._generator(e),e=i({clientSdkMetadata:this._clientSdkMetadata},e);return JSON.stringify(e)},d.prototype.getMethod=function(){return"POST"},d.prototype.getHeaders=function(){var e=this._data.authorizationFingerprint?(this._sendAnalyticsEvent("graphql.authorization-fingerprint"),this._data.authorizationFingerprint):(this._sendAnalyticsEvent("graphql.tokenization-key"),this._data.tokenizationKey);return i({},this._headers,{Authorization:"Bearer "+e,"Braintree-Version":n})},d.prototype.adaptResponseBody=function(e){return this._adapter(e,this)},d.prototype.determineStatus=function(e,t){var r,n=200===e?(r=t.errors&&t.errors[0]&&t.errors[0].extensions&&t.errors[0].extensions.errorClass,t.data&&!t.errors?200:"VALIDATION"===r?422:"AUTHORIZATION"===r?403:"AUTHENTICATION"===r?401:(n=t,!r&&n.errors[0].message?403:500)):e||500;return this._sendAnalyticsEvent("graphql.status."+e),this._sendAnalyticsEvent("graphql.determinedStatus."+n),n},t.exports=d},{"../../../lib/assign":41,"../../constants":18,"./adapters/configuration":25,"./adapters/credit-card-tokenization":26,"./generators/configuration":28,"./generators/credit-card-tokenization":29}],32:[function(e,t,r){"use strict";var n,i=e("../../lib/once"),o=e("./jsonp-driver"),a=e("./ajax-driver"),s=e("./get-user-agent"),c=e("./is-http");t.exports=function(e,t){t=i(t||Function.prototype),e.method=(e.method||"GET").toUpperCase(),e.timeout=null==e.timeout?6e4:e.timeout,e.data=e.data||{},((n=null==n?!(c()&&/MSIE\s(8|9)/.test(s())):n)?a:o).request(e,t)}},{"../../lib/once":54,"./ajax-driver":22,"./get-user-agent":24,"./is-http":33,"./jsonp-driver":34}],33:[function(e,t,r){"use strict";t.exports=function(){return"http:"===window.location.protocol}},{}],34:[function(e,t,r){"use strict";var d,p=e("@braintree/uuid"),l=e("../../lib/querystring"),f={};function h(t){try{delete window[t]}catch(e){window[t]=null}}t.exports={request:function(e,t){var r,n,i,o,a="callback_json_"+p().replace(/-/g,""),s=e.url,c=e.data,u=e.method,e=e.timeout,s=l.queryify(s,c);s=l.queryify(s,{_method:u,callback:a}),r=a,n=document.createElement("script"),i=!1,n.src=s,n["async"]=!0,n.onerror=function(){window[r]({message:"error",status:500})},n.onload=n.onreadystatechange=function(){i||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(i=!0,n.onload=n.onreadystatechange=null)},function(i,o,a){window[a]=function(e){var t=e.status||500,r=null,n=null;delete e.status,400<=t||t<200?r=e:n=e,h(a),(e=i)&&e.parentNode&&e.parentNode.removeChild(e),clearTimeout(f[a]),o(r,n,t)}}(s=n,t,a),f[o=a]=setTimeout(function(){f[o]=null,window[o]({error:"timeout",status:-1}),window[o]=function(){h(o)}},e),(d=d||document.getElementsByTagName("head")[0]).appendChild(s)}}},{"../../lib/querystring":56,"@braintree/uuid":10}],35:[function(e,t,r){"use strict";t.exports=function(e){try{e=JSON.parse(e)}catch(e){}return e}},{}],36:[function(e,t,r){"use strict";t.exports=function(e,t){if("string"!=typeof e)throw new Error("Method must be a string");return"get"===e.toLowerCase()||null==t||"string"==typeof t?t:JSON.stringify(t)}},{}],37:[function(e,t,r){"use strict";var n="undefined"!=typeof window&&window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest;t.exports={isAvailable:n,getRequestObject:function(){return new(n?window.XMLHttpRequest:window.XDomainRequest)}}},{}],38:[function(e,t,r){"use strict";var o=e("./create-authorization-data"),a=e("./json-clone"),s=e("./constants");t.exports=function(e,t){var r,n=t?a(t):{},t=o(e.authorization).attrs,i=a(e.analyticsMetadata);for(r in n.braintreeLibraryVersion=s.BRAINTREE_LIBRARY_VERSION,n._meta)n._meta.hasOwnProperty(r)&&(i[r]=n._meta[r]);return n._meta=i,t.tokenizationKey?n.tokenizationKey=t.tokenizationKey:n.authorizationFingerprint=t.authorizationFingerprint,n}},{"./constants":43,"./create-authorization-data":46,"./json-clone":52}],39:[function(e,t,r){"use strict";var n=e("./promise"),s=e("./constants"),c=e("./add-metadata");t.exports={sendEvent:function(e,i,o){var a=Date.now();return n.resolve(e).then(function(e){var t=Date.now(),r=e.getConfiguration(),n=e._request,e=r.gatewayConfiguration.analytics.url,t={analytics:[{kind:s.ANALYTICS_PREFIX+i,isAsync:Math.floor(t/1e3)!==Math.floor(a/1e3),timestamp:a}]};n({url:e,method:"post",data:c(r,t),timeout:s.ANALYTICS_REQUEST_TIMEOUT_MS},o)})}}},{"./add-metadata":38,"./constants":43,"./promise":55}],40:[function(e,t,r){"use strict";e=e("@braintree/asset-loader/load-script"),t.exports={loadScript:e}},{"@braintree/asset-loader/load-script":3}],41:[function(e,t,r){"use strict";var n="function"==typeof Object.assign?Object.assign:i;function i(e){for(var t,r,n=1;n<arguments.length;n++)for(r in t=arguments[n])t.hasOwnProperty(r)&&(e[r]=t[r]);return e}t.exports={assign:n,_assign:i}},{}],42:[function(e,t,r){"use strict";function n(e){if(!n.types.hasOwnProperty(e.type))throw new Error(e.type+" is not a valid type.");if(!e.code)throw new Error("Error code required.");if(!e.message)throw new Error("Error message required.");this.name="BraintreeError",this.code=e.code,this.message=e.message,this.type=e.type,this.details=e.details}e=e("./enumerate"),((n.prototype=Object.create(Error.prototype)).constructor=n).types=e(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]),n.findRootError=function(e){return e instanceof n&&e.details&&e.details.originalError?n.findRootError(e.details.originalError):e},t.exports=n},{"./enumerate":48}],43:[function(e,t,r){"use strict";t.exports={ANALYTICS_PREFIX:"web.",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:{production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"},CLIENT_API_URLS:{production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"},FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",BUS_CONFIGURATION_REQUEST_EVENT:"BUS_CONFIGURATION_REQUEST",GRAPHQL_URLS:{production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"},INTEGRATION_TIMEOUT_MS:6e4,VERSION:"3.82.0",INTEGRATION:"custom",SOURCE:"client",PLATFORM:"web",BRAINTREE_LIBRARY_VERSION:"braintree/web/3.82.0"}},{}],44:[function(e,t,r){"use strict";var n=e("./braintree-error"),i=e("./errors");t.exports=function(t,e){e.forEach(function(e){t[e]=function(){throw new n({type:i.METHOD_CALLED_AFTER_TEARDOWN.type,code:i.METHOD_CALLED_AFTER_TEARDOWN.code,message:e+" cannot be called after teardown."})}})}},{"./braintree-error":42,"./errors":49}],45:[function(e,t,r){"use strict";var n=e("./braintree-error");t.exports=function(e,t){return e instanceof n?e:new n({type:t.type,code:t.code,message:t.message,details:{originalError:e}})}},{"./braintree-error":42}],46:[function(e,t,r){"use strict";var i=e("../lib/vendor/polyfill").atob,o=e("../lib/constants").CLIENT_API_URLS;t.exports=function(e){var t,r,n={attrs:{},configUrl:""};return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(e)?(t=(r=(t=e).split("_"))[0],t={merchantId:r.slice(2).join("_"),environment:t},n.environment=t.environment,n.attrs.tokenizationKey=e,n.configUrl=o[t.environment]+"/merchants/"+t.merchantId+"/client_api/v1/configuration"):(e=JSON.parse(i(e)),n.environment=e.environment,n.attrs.authorizationFingerprint=e.authorizationFingerprint,n.configUrl=e.configUrl,n.graphQL=e.graphQL),n}},{"../lib/constants":43,"../lib/vendor/polyfill":57}],47:[function(e,t,r){"use strict";t.exports=function(t){return function(){var e=arguments;setTimeout(function(){t.apply(null,e)},1)}}},{}],48:[function(e,t,r){"use strict";t.exports=function(e,r){return r=null==r?"":r,e.reduce(function(e,t){return e[t]=r+t,e},{})}},{}],49:[function(e,t,r){"use strict";e=e("./braintree-error"),t.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:e.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:e.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:e.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:e.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:e.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"}}},{"./braintree-error":42}],50:[function(e,t,r){"use strict";function n(e){return e=e.split("-"),new Date(e[0],e[1],e[2])}t.exports=function(e,t){return n(e)<=n(t)}},{}],51:[function(e,t,r){"use strict";var n,i={"paypal.com":1,"braintreepayments.com":1,"braintreegateway.com":1,"braintree-api.com":1};t.exports=function(e){return e=e.toLowerCase(),!!/^https:/.test(e)&&((n=n||document.createElement("a")).href=e,e=n.hostname.split(".").slice(-2).join("."),i.hasOwnProperty(e))}},{}],52:[function(e,t,r){"use strict";t.exports=function(e){return JSON.parse(JSON.stringify(e))}},{}],53:[function(e,t,r){"use strict";t.exports=function(t){return Object.keys(t).filter(function(e){return"function"==typeof t[e]})}},{}],54:[function(e,t,r){"use strict";t.exports=function(e){var t=!1;return function(){t||(t=!0,e.apply(null,arguments))}}},{}],55:[function(e,t,r){"use strict";var n=e("promise-polyfill"),e=e("@braintree/extended-promise"),n="undefined"!=typeof Promise?Promise:n;e.suppressUnhandledPromiseMessage=!0,e.setPromise(n),t.exports=n},{"@braintree/extended-promise":9,"promise-polyfill":15}],56:[function(e,t,r){"use strict";function n(e){return e=e||window.location.href,/\?/.test(e)}function a(e,t){var r,n,i,o=[];for(n in e)e.hasOwnProperty(n)&&(r=e[n],i=t?(i=e)&&"object"==typeof i&&"number"==typeof i.length&&"[object Array]"===Object.prototype.toString.call(i)?t+"[]":t+"["+n+"]":n,"object"==typeof r?o.push(a(r,i)):o.push(encodeURIComponent(i)+"="+encodeURIComponent(r)));return o.join("&")}t.exports={parse:function(e){return n(e=e||window.location.href)?e.replace(/#.*$/,"").replace(/^.*\?/,"").split("&").reduce(function(e,t){var r=t.split("="),t=decodeURIComponent(r[0]),r=decodeURIComponent(r[1]);return e[t]=r,e},{}):{}},stringify:a,queryify:function(e,t){return e=e||"",null!=t&&"object"==typeof t&&function(e){for(var t in e)if(e.hasOwnProperty(t))return 1}(t)&&(e+=-1===e.indexOf("?")?"?":"",e+=-1!==e.indexOf("=")?"&":"",e+=a(t)),e},hasQueryParams:n}},{}],57:[function(e,t,r){"use strict";var n="function"==typeof atob?atob:i;function i(e){var t,r,n,i,o,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";if(!new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$").test(e))throw new Error("Non base64 encoded input passed to window.atob polyfill");for(o=0;r=a.indexOf(e.charAt(o++)),t=(15&(n=a.indexOf(e.charAt(o++))))<<4|(i=a.indexOf(e.charAt(o++)))>>2&15,i=(3&i)<<6|63&a.indexOf(e.charAt(o++)),s+=String.fromCharCode((63&r)<<2|n>>4&3)+(t?String.fromCharCode(t):"")+(i?String.fromCharCode(i):""),o<e.length;);return s}t.exports={atob:function(e){return n.call(window,e)},_atob:i}},{}]},{},[21])(21)}),function(e){var t;"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).braintree||(t.braintree={})).dataCollector=e()}(function(){return function r(i,o,s){function a(t,e){if(!o[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=o[t]={exports:{}},i[t][0].call(n.exports,function(e){return a(i[t][1][e]||e)},n,n.exports,r,i,o,s)}return o[t].exports}for(var c="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(n,"__esModule",{value:!0}),n.PromiseGlobal=void 0,e=r(e("promise-polyfill")),e="undefined"!=typeof Promise?Promise:e["default"],n.PromiseGlobal=e},{"promise-polyfill":9}],2:[function(e,t,n){"use strict";var s=e("./lib/promise"),a={};function r(n){var e,t=JSON.stringify(n);if(!n.forceScriptReload&&(e=a[t]))return e;var r=document.createElement("script"),i=n.dataAttributes||{},o=n.container||document.head;return r.src=n.src,r.id=n.id||"",r["async"]=!0,n.crossorigin&&r.setAttribute("crossorigin",""+n.crossorigin),Object.keys(i).forEach(function(e){r.setAttribute("data-"+e,""+i[e])}),e=new s.PromiseGlobal(function(e,t){r.addEventListener("load",function(){e(r)}),r.addEventListener("error",function(){t(new Error(n.src+" failed to load."))}),r.addEventListener("abort",function(){t(new Error(n.src+" has aborted."))}),o.appendChild(r)}),a[t]=e}r.clearCache=function(){a={}},t.exports=r},{"./lib/promise":1}],3:[function(e,t,n){t.exports=e("./dist/load-script")},{"./dist/load-script":2}],4:[function(e,t,n){"use strict";var r="undefined"!=typeof Promise?Promise:null,r=(i.defaultOnResolve=function(e){return i.Promise.resolve(e)},i.defaultOnReject=function(e){return i.Promise.reject(e)},i.setPromise=function(e){i.Promise=e},i.shouldCatchExceptions=function(e){return e.hasOwnProperty("suppressUnhandledPromiseMessage")?Boolean(e.suppressUnhandledPromiseMessage):Boolean(i.suppressUnhandledPromiseMessage)},i.all=function(e){return i.Promise.all(e)},i.allSettled=function(e){return i.Promise.allSettled(e)},i.race=function(e){return i.Promise.race(e)},i.reject=function(e){return i.Promise.reject(e)},i.resolve=function(e){return i.Promise.resolve(e)},i.prototype.then=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._promise).then.apply(e,t)},i.prototype["catch"]=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._promise)["catch"].apply(e,t)},i.prototype.resolve=function(e){var t=this;return this.isFulfilled||(this._setResolved(),i.Promise.resolve().then(function(){return t._onResolve(e)}).then(function(e){t._resolveFunction(e)})["catch"](function(e){t._resetState(),t.reject(e)})),this},i.prototype.reject=function(e){var t=this;return this.isFulfilled||(this._setRejected(),i.Promise.resolve().then(function(){return t._onReject(e)}).then(function(e){t._setResolved(),t._resolveFunction(e)})["catch"](function(e){return t._rejectFunction(e)})),this},i.prototype._resetState=function(){this.isFulfilled=!1,this.isResolved=!1,this.isRejected=!1},i.prototype._setResolved=function(){this.isFulfilled=!0,this.isResolved=!0,this.isRejected=!1},i.prototype._setRejected=function(){this.isFulfilled=!0,this.isResolved=!1,this.isRejected=!0},i.Promise=r,i);function i(e){var n=this;"function"!=typeof e?(this._promise=new i.Promise(function(e,t){n._resolveFunction=e,n._rejectFunction=t}),this._onResolve=(e=e||{}).onResolve||i.defaultOnResolve,this._onReject=e.onReject||i.defaultOnReject,i.shouldCatchExceptions(e)&&this._promise["catch"](function(){}),this._resetState()):this._promise=new i.Promise(e)}t.exports=r},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.deferred=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];setTimeout(function(){try{n.apply(void 0,e)}catch(e){console.log("Error in callback function"),console.log(e)}},1)}}},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.once=function(n){var r=!1;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||(r=!0,n.apply(void 0,e))}}},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.promiseOrCallback=function(e,t){if(!t)return e;e.then(function(e){return t(null,e)})["catch"](function(e){return t(e)})}},{}],8:[function(e,t,n){"use strict";var i=e("./lib/deferred"),o=e("./lib/once"),s=e("./lib/promise-or-callback");function a(r){return function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"function"==typeof t[t.length-1]&&(e=t.pop(),e=o.once(i.deferred(e))),s.promiseOrCallback(r.apply(this,t),e)}}a.wrapPrototype=function(r,e){var i=(e=void 0===e?{}:e).ignoreMethods||[],o=!0===e.transformPrivateMethods;return Object.getOwnPropertyNames(r.prototype).filter(function(e){var t="constructor"!==e&&"function"==typeof r.prototype[e],n=-1===i.indexOf(e),e=o||"_"!==e.charAt(0);return t&&e&&n}).forEach(function(e){var t=r.prototype[e];r.prototype[e]=a(t)}),r},t.exports=a},{"./lib/deferred":5,"./lib/once":6,"./lib/promise-or-callback":7}],9:[function(e,t,n){"use strict";var r=setTimeout;function c(e){return Boolean(e&&void 0!==e.length)}function i(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function s(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,o._immediateFn(function(){var e,t=1===n._state?r.onFulfilled:r.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void u(r.promise,e)}a(r.promise,e)}else(1===n._state?a:u)(r.promise,n._value)})):n._deferreds.push(r)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void l(t);if("function"==typeof n)return void f((r=n,i=e,function(){r.apply(i,arguments)}),t)}t._state=1,t._value=e,l(t)}catch(e){u(t,e)}var r,i}function u(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)s(e,e._deferreds[t]);e._deferreds=null}function h(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,u(t,e))})}catch(e){if(n)return;n=!0,u(t,e)}}o.prototype["catch"]=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=new this.constructor(i);return s(this,new h(e,t,n)),n},o.prototype["finally"]=function(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})},o.all=function(t){return new o(function(i,o){if(!c(t))return o(new TypeError("Promise.all accepts an array"));var s=Array.prototype.slice.call(t);if(0===s.length)return i([]);for(var a=s.length,e=0;e<s.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return void r.call(e,function(e){t(n,e)},o)}s[n]=e,0==--a&&i(s)}catch(e){o(e)}}(e,s[e])})},o.allSettled=function(n){return new this(function(i,e){if(!n||void 0===n.length)return e(new TypeError(typeof n+" "+n+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var o=Array.prototype.slice.call(n);if(0===o.length)return i([]);for(var s=o.length,t=0;t<o.length;t++)!function t(n,e){if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return void r.call(e,function(e){t(n,e)},function(e){o[n]={status:"rejected",reason:e},0==--s&&i(o)})}o[n]={status:"fulfilled",value:e},0==--s&&i(o)}(t,o[t])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(n){return new o(function(e,t){t(n)})},o.race=function(i){return new o(function(e,t){if(!c(i))return t(new TypeError("Promise.race accepts an array"));for(var n=0,r=i.length;n<r;n++)o.resolve(i[n]).then(e,t)})},o._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){r(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t.exports=o},{}],10:[function(e,t,n){"use strict";e=e("../lib/braintree-error"),t.exports={DATA_COLLECTOR_KOUNT_NOT_ENABLED:{type:e.types.MERCHANT,code:"DATA_COLLECTOR_KOUNT_NOT_ENABLED",message:"Kount is not enabled for this merchant."},DATA_COLLECTOR_KOUNT_ERROR:{type:e.types.MERCHANT,code:"DATA_COLLECTOR_KOUNT_ERROR"},DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS:{type:e.types.MERCHANT,code:"DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS",message:"Data Collector must be created with Kount and/or PayPal."}}},{"../lib/braintree-error":17}],11:[function(e,t,n){"use strict";var i,o=e("../lib/constants").FRAUDNET_FNCLS,s=e("../lib/constants").FRAUDNET_SOURCE,a=e("../lib/constants").FRAUDNET_URL,c=e("../lib/assets").loadScript,r=e("../lib/promise");function u(){}function l(e){e&&e.parentNode&&e.parentNode.removeChild(e)}u.prototype.initialize=function(e){var n=e.environment,r=this;return this.sessionId=e.sessionId||function(){for(var t="",e=0;e<32;e++)t+=Math.floor(16*Math.random()).toString(16);return t}(),e.sessionId||(i=this.sessionId),this._beaconId="https://b.stats.paypal.com/counter.cgi?i=127.0.0.1&p="+this.sessionId+"&t="+(e=(new Date).getTime()/1e3)+"&a=14",this._parameterBlock=function(e,t,n){var r=document.body.appendChild(document.createElement("script")),t={f:e,s:s,b:t};return"production"!==n&&(t.sandbox=!0),r.type="application/json",r.setAttribute("fncls",o),r.text=JSON.stringify(t),r}(this.sessionId,this._beaconId,n),c({src:a}).then(function(e){return r._thirdPartyBlock=e,r})["catch"](function(){return null})},u.prototype.teardown=function(){l(document.querySelector('iframe[title="ppfniframe"]')),l(document.querySelector('iframe[title="pbf"]')),l(this._parameterBlock),l(this._thirdPartyBlock)},t.exports={setup:function(e){var t=new u;return!(e=e||{}).sessionId&&i?(t.sessionId=i,r.resolve(t)):t.initialize(e)},clearSessionIdCache:function(){i=null}}},{"../lib/assets":15,"../lib/constants":19,"../lib/promise":26}],12:[function(e,t,n){"use strict";var s=e("./kount"),a=e("./fraudnet"),c=e("../lib/braintree-error"),u=e("../lib/basic-component-verification"),l=e("../lib/create-deferred-client"),h=e("../lib/create-assets-url"),f=e("../lib/methods"),d=e("../lib/convert-methods-to-error"),p=e("../lib/promise"),m=e("@braintree/wrap-promise"),v=e("./errors");t.exports={create:m(function(r){var i,n="Data Collector",o={_instances:[]};return u.verify({name:n,client:r.client,authorization:r.authorization}).then(function(){var e,t;return o._instantiatedWithAClient=!r.useDeferredClient,o._createPromise=l.create({authorization:r.authorization,client:r.client,debug:r.debug,assetsUrl:h.create(r.authorization),name:n}).then(function(e){var t,n=e.getConfiguration();if(!0===r.kount&&n.gatewayConfiguration.kount){try{t=s.setup({environment:n.gatewayConfiguration.environment,merchantId:n.gatewayConfiguration.kount.kountMerchantId})}catch(e){return p.reject(new c({type:v.DATA_COLLECTOR_KOUNT_ERROR.type,code:v.DATA_COLLECTOR_KOUNT_ERROR.code,message:e.message}))}i=t.deviceData,o._instances.push(t)}else i={};return p.resolve(e)}).then(function(e){return a.setup({sessionId:r.clientMetadataId||r.correlationId,environment:e.getConfiguration().gatewayConfiguration.environment}).then(function(e){e&&(i.correlation_id=e.sessionId,o._instances.push(e))})}).then(function(){return 0===o._instances.length?p.reject(new c(v.DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS)):(o.deviceData=JSON.stringify(i),o.rawDeviceData=i,o)}),o.teardown=(e=o,m(function(){return e._createPromise.then(function(){e._instances.forEach(function(e){e&&e.teardown()}),d(e,f(e))})})),o.getDeviceData=(t=o,m(function(e){return e=e||{},t._createPromise.then(function(){return e.raw?p.resolve(t.rawDeviceData):p.resolve(t.deviceData)})})),o._instantiatedWithAClient?o._createPromise:o})}),VERSION:"3.82.0"}},{"../lib/basic-component-verification":16,"../lib/braintree-error":17,"../lib/convert-methods-to-error":20,"../lib/create-assets-url":21,"../lib/create-deferred-client":22,"../lib/methods":25,"../lib/promise":26,"./errors":10,"./fraudnet":11,"./kount":13,"@braintree/wrap-promise":8}],13:[function(e,t,n){"use strict";var r=e("./vendor/sjcl"),i=e("../lib/camel-case-to-snake-case"),o={development:e="https://assets.qa.braintreepayments.com/data",qa:e,sandbox:"https://assets.braintreegateway.com/sandbox/data",production:"https://assets.braintreegateway.com/data"},s={};function a(e){var t=a.getCachedDeviceData(e.merchantId);if(t)return this.deviceData=t,void(this._isCached=!0);this._currentEnvironment=this._initializeEnvironment(e),r.random.startCollectors(),this._deviceSessionId=this._generateDeviceSessionId(),this.deviceData=this._getDeviceData(),a.setCachedDeviceData(e.merchantId,this.deviceData),this._iframe=this._setupIFrame()}a.getCachedDeviceData=function(e){return s[e]},a.setCachedDeviceData=function(e,t){s[e]=t},a.prototype.teardown=function(){this._isCached||(r.random.stopCollectors(),this._removeIframe())},a.prototype._removeIframe=function(){this._iframe.parentNode.removeChild(this._iframe)},a.prototype._getDeviceData=function(){return i({deviceSessionId:this._deviceSessionId,fraudMerchantId:this._currentEnvironment.id})},a.prototype._generateDeviceSessionId=function(){var e=r.random.randomWords(4,0);return r.codec.hex.fromBits(e)},a.prototype._setupIFrame=function(){var e=this,t="?m="+this._currentEnvironment.id+"&s="+this._deviceSessionId,n=document.createElement("iframe");return n.width=1,n.id="braintreeDataFrame-"+this._deviceSessionId,n.height=1,n.frameBorder=0,n.scrolling="no",n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",n.title="Braintree-Kount-iframe",n.setAttribute("aria-hidden","true"),document.body.appendChild(n),setTimeout(function(){n.src=e._currentEnvironment.url+"/logo.htm"+t,n.innerHTML='<img src="'+e._currentEnvironment.url+"/logo.gif"+t+'" alt="" />'},10),n},a.prototype._initializeEnvironment=function(e){var t=o[e.environment];if(null==t)throw new Error(e.environment+" is not a valid environment for kount.environment");return{url:t,name:e.environment,id:e.merchantId}},t.exports={setup:function(e){return new a(null!=e?e:{})},Kount:a,environmentUrls:o}},{"../lib/camel-case-to-snake-case":18,"./vendor/sjcl":14}],14:[function(e,t,n){"use strict";var r,i,o,s,a,_={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};function c(e,t,n){if(4!==t.length)throw new _.exception.invalid("invalid aes block size");var r=e.b[n],i=t[0]^r[0],o=t[n?3:1]^r[1],s=t[2]^r[2];t=t[n?1:3]^r[3];var a,c,u=r.length/4-2,l=4,h=[0,0,0,0],f=e.l[n];e=f[0];for(var d=f[1],p=f[2],m=f[3],v=f[4],y=0;y<u;y++)f=e[i>>>24]^d[o>>16&255]^p[s>>8&255]^m[255&t]^r[l],a=e[o>>>24]^d[s>>16&255]^p[t>>8&255]^m[255&i]^r[l+1],c=e[s>>>24]^d[t>>16&255]^p[i>>8&255]^m[255&o]^r[l+2],t=e[t>>>24]^d[i>>16&255]^p[o>>8&255]^m[255&s]^r[l+3],l+=4,i=f,o=a,s=c;for(y=0;y<4;y++)h[n?3&-y:y]=v[i>>>24]<<24^v[o>>16&255]<<16^v[s>>8&255]<<8^v[255&t]^r[l++],f=i,i=o,o=s,s=t,t=f;return h}function u(e,t){for(var n,r,i=e.u,o=e.b,s=i[0],a=i[1],c=i[2],u=i[3],l=i[4],h=i[5],f=i[6],d=i[7],p=0;p<64;p++)n=(n=p<16?t[p]:(n=t[p+1&15],r=t[p+14&15],t[15&p]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+t[15&p]+t[p+9&15]|0))+d+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(f^l&(h^f))+o[p],d=f,f=h,h=l,l=u+n|0,u=c,c=a,s=n+((a=s)&c^u&(a^c))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;i[0]=i[0]+s|0,i[1]=i[1]+a|0,i[2]=i[2]+c|0,i[3]=i[3]+u|0,i[4]=i[4]+l|0,i[5]=i[5]+h|0,i[6]=i[6]+f|0,i[7]=i[7]+d|0}function l(e,t){var n,r=_.random.B[e],i=[];for(n in r)r.hasOwnProperty(n)&&i.push(r[n]);for(n=0;n<i.length;n++)i[n](t)}function h(e,t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy((new Date).valueOf(),t,"loadtime")}function f(e){e.b=d(e).concat(d(e)),e.C=new _.cipher.aes(e.b)}function d(e){for(var t=0;t<4&&(e.g[t]=e.g[t]+1|0,!e.g[t]);t++);return e.C.encrypt(e.g)}function p(e,t){return function(){t.apply(e,arguments)}}_.cipher.aes=function(e){this.l[0][0][0]||this.G();var t,n,r,i=this.l[0][4],o=this.l[1],s=e.length,a=1;if(4!==s&&6!==s&&8!==s)throw new _.exception.invalid("invalid aes key size");for(this.b=[n=e.slice(0),r=[]],e=s;e<4*s+28;e++)t=n[e-1],(0==e%s||8===s&&4==e%s)&&(t=i[t>>>24]<<24^i[t>>16&255]<<16^i[t>>8&255]<<8^i[255&t],0==e%s&&(t=t<<8^t>>>24^a<<24,a=a<<1^283*(a>>7))),n[e]=n[e-s]^t;for(s=0;e;s++,e--)t=n[3&s?e:e-4],r[s]=e<=4||s<4?t:o[0][i[t>>>24]]^o[1][i[t>>16&255]]^o[2][i[t>>8&255]]^o[3][i[255&t]]},_.cipher.aes.prototype={encrypt:function(e){return c(this,e,0)},decrypt:function(e){return c(this,e,1)},l:[[[],[],[],[],[]],[[],[],[],[],[]]],G:function(){for(var e,t,n,r,i,o,s=this.l[0],a=this.l[1],c=s[4],u=a[4],l=[],h=[],f=0;f<256;f++)h[(l[f]=f<<1^283*(f>>7))^f]=f;for(e=t=0;!c[e];e^=n||1,t=h[t]||1)for(o=16843009*(r=l[f=l[n=l[u[c[e]=i=(i=t^t<<1^t<<2^t<<3^t<<4)>>8^255&i^99]=e]]])^65537*f^257*n^16843008*e,r=257*l[i]^16843008*i,f=0;f<4;f++)s[f][e]=r=r<<24^r>>>8,a[f][i]=o=o<<24^o>>>8;for(f=0;f<5;f++)s[f]=s[f].slice(0),a[f]=a[f].slice(0)}},_.bitArray={bitSlice:function(e,t,n){return e=_.bitArray.M(e.slice(t/32),32-(31&t)).slice(1),void 0===n?e:_.bitArray.clamp(e,n-t)},extract:function(e,t,n){var r=Math.floor(-t-n&31);return(-32&(t+n-1^t)?e[t/32|0]<<32-r^e[t/32+1|0]>>>r:e[t/32|0]>>>r)&(1<<n)-1},concat:function(e,t){if(0===e.length||0===t.length)return e.concat(t);var n=e[e.length-1],r=_.bitArray.getPartial(n);return 32===r?e.concat(t):_.bitArray.M(t,r,0|n,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return 0===t?0:32*(t-1)+_.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;var n=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,0<n&&t&&(e[n-1]=_.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(_.bitArray.bitLength(e)!==_.bitArray.bitLength(t))return!1;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n},M:function(e,t,n,r){var i=0;for(void 0===r&&(r=[]);32<=t;t-=32)r.push(n),n=0;if(0===t)return r.concat(e);for(i=0;i<e.length;i++)r.push(n|e[i]>>>t),n=e[i]<<32-t;return i=e.length?e[e.length-1]:0,e=_.bitArray.getPartial(i),r.push(_.bitArray.partial(t+e&31,32<t+e?n:r.pop(),1)),r},Y:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){for(var t,n=0;n<e.length;++n)t=e[n],e[n]=t>>>24|t>>>8&65280|(65280&t)<<8|t<<24;return e}},_.codec.utf8String={fromBits:function(e){for(var t,n="",r=_.bitArray.bitLength(e),i=0;i<r/8;i++)0==(3&i)&&(t=e[i/4]),n+=String.fromCharCode(t>>>8>>>8>>>8),t<<=8;return decodeURIComponent(escape(n))},toBits:function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0,r=0;r<e.length;r++)n=n<<8|e.charCodeAt(r),3==(3&r)&&(t.push(n),n=0);return 3&r&&t.push(_.bitArray.partial(8*(3&r),n)),t}},_.codec.hex={fromBits:function(e){for(var t="",n=0;n<e.length;n++)t+=(0xf00000000000+(0|e[n])).toString(16).substr(4);return t.substr(0,_.bitArray.bitLength(e)/4)},toBits:function(e){var t,n=[],r=(e=e.replace(/\s|0x/g,"")).length;for(e+="00000000",t=0;t<e.length;t+=8)n.push(0^parseInt(e.substr(t,8),16));return _.bitArray.clamp(n,4*r)}},_.hash.sha256=function(e){this.b[0]||this.G(),e?(this.u=e.u.slice(0),this.o=e.o.slice(0),this.h=e.h):this.reset()},_.hash.sha256.hash=function(e){return(new _.hash.sha256).update(e).finalize()},_.hash.sha256.prototype={blockSize:512,reset:function(){return this.u=this.K.slice(0),this.o=[],this.h=0,this},update:function(e){"string"==typeof e&&(e=_.codec.utf8String.toBits(e));var t=this.o=_.bitArray.concat(this.o,e),i=this.h;if(9007199254740991<(e=this.h=i+_.bitArray.bitLength(e)))throw new _.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){for(var n=new Uint32Array(t),r=0,i=512+i-(512+i&511);i<=e;i+=512)u(this,n.subarray(16*r,16*(r+1))),r+=1;t.splice(0,16*r)}else for(i=512+i-(512+i&511);i<=e;i+=512)u(this,t.splice(0,16));return this},finalize:function(){for(var e=this.o,t=this.u,n=(e=_.bitArray.concat(e,[_.bitArray.partial(1,1)])).length+2;15&n;n++)e.push(0);for(e.push(Math.floor(this.h/4294967296)),e.push(0|this.h);e.length;)u(this,e.splice(0,16));return this.reset(),t},K:[],b:[],G:function(){function e(e){return 4294967296*(e-Math.floor(e))|0}for(var t,n,r=0,i=2;r<64;i++){for(n=!0,t=2;t*t<=i;t++)if(0==i%t){n=!1;break}n&&(r<8&&(this.K[r]=e(Math.pow(i,.5))),this.b[r]=e(Math.pow(i,1/3)),r++)}}},_.prng=function(e){this.c=[new _.hash.sha256],this.i=[0],this.H=0,this.v={},this.F=0,this.J={},this.L=this.f=this.j=this.T=0,this.b=[0,0,0,0,0,0,0,0],this.g=[0,0,0,0],this.C=void 0,this.D=e,this.s=!1,this.B={progress:{},seeded:{}},this.m=this.S=0,this.w=1,this.A=2,this.O=65536,this.I=[0,48,64,96,128,192,256,384,512,768,1024],this.P=3e4,this.N=80},_.prng.prototype={randomWords:function(e,t){var n=[];if((i=this.isReady(t))===this.m)throw new _.exception.notReady("generator isn't seeded");if(i&this.A){var r,i=!(i&this.w),o=[],s=0;for(this.L=o[0]=(new Date).valueOf()+this.P,r=0;r<16;r++)o.push(4294967296*Math.random()|0);for(r=0;r<this.c.length&&(o=o.concat(this.c[r].finalize()),s+=this.i[r],this.i[r]=0,i||!(this.H&1<<r));r++);for(this.H>=1<<this.c.length&&(this.c.push(new _.hash.sha256),this.i.push(0)),this.f-=s,s>this.j&&(this.j=s),this.H++,this.b=_.hash.sha256.hash(this.b.concat(o)),this.C=new _.cipher.aes(this.b),i=0;i<4&&(this.g[i]=this.g[i]+1|0,!this.g[i]);i++);}for(i=0;i<e;i+=4)0==(i+1)%this.O&&f(this),o=d(this),n.push(o[0],o[1],o[2],o[3]);return f(this),n.slice(0,e)},setDefaultParanoia:function(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw new _.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.D=e},addEntropy:function(e,t,n){n=n||"user";var r,i=(new Date).valueOf(),o=this.v[n],s=this.isReady(),a=0,c=this.J[n];switch(void 0===c&&(c=this.J[n]=this.T++),void 0===o&&(o=this.v[n]=0),this.v[n]=(this.v[n]+1)%this.c.length,typeof e){case"number":void 0===t&&(t=1),this.c[o].update([c,this.F++,1,t,i,1,0|e]);break;case"object":if("[object Uint32Array]"===(n=Object.prototype.toString.call(e))){for(r=[],n=0;n<e.length;n++)r.push(e[n]);e=r}else for("[object Array]"!==n&&(a=1),n=0;n<e.length&&!a;n++)"number"!=typeof e[n]&&(a=1);if(!a){if(void 0===t)for(n=t=0;n<e.length;n++)for(r=e[n];0<r;)t++,r>>>=1;this.c[o].update([c,this.F++,2,t,i,e.length].concat(e))}break;case"string":void 0===t&&(t=e.length),this.c[o].update([c,this.F++,3,t,i,e.length]),this.c[o].update(e);break;default:a=1}if(a)throw new _.exception.bug("random: addEntropy only supports number, array of numbers or string");this.i[o]+=t,this.f+=t,s===this.m&&(this.isReady()!==this.m&&l("seeded",Math.max(this.j,this.f)),l("progress",this.getProgress()))},isReady:function(e){return e=this.I[void 0!==e?e:this.D],this.j&&this.j>=e?this.i[0]>this.N&&(new Date).valueOf()>this.L?this.A|this.w:this.w:this.f>=e?this.A|this.m:this.m},getProgress:function(e){return e=this.I[e||this.D],this.j>=e||this.f>e?1:this.f/e},startCollectors:function(){if(!this.s){if(this.a={loadTimeCollector:p(this,this.V),mouseCollector:p(this,this.W),keyboardCollector:p(this,this.U),accelerometerCollector:p(this,this.R),touchCollector:p(this,this.X)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else{if(!document.attachEvent)throw new _.exception.bug("can't attach event");document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)}this.s=!0}},stopCollectors:function(){this.s&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.s=!1)},addEventListener:function(e,t){this.B[e][this.S++]=t},removeEventListener:function(e,t){var n,r,i=this.B[e],o=[];for(r in i)i.hasOwnProperty(r)&&i[r]===t&&o.push(r);for(n=0;n<o.length;n++)delete i[r=o[n]]},U:function(){h(this,1)},W:function(e){var t,n;try{t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0}catch(e){n=t=0}0!=t&&0!=n&&this.addEntropy([t,n],2,"mouse"),h(this,0)},X:function(e){e=e.touches[0]||e.changedTouches[0],this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch"),h(this,0)},V:function(){h(this,2)},R:function(e){var t;e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,!window.orientation||"number"==typeof(t=window.orientation)&&this.addEntropy(t,1,"accelerometer"),e&&this.addEntropy(e,2,"accelerometer"),h(this,0)}},_.random=new _.prng(6);e:try{if(s=void 0!==t&&t.exports){try{a=e("crypto")}catch(e){a=null}s=i=a}if(s&&i.randomBytes)r=i.randomBytes(128),r=new Uint32Array(new Uint8Array(r).buffer),_.random.addEntropy(r,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(o=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(o);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break e;window.msCrypto.getRandomValues(o)}_.random.addEntropy(o,1024,"crypto['getRandomValues']")}}catch(e){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}void 0!==t&&t.exports&&(t.exports=_)},{crypto:void 0}],15:[function(e,t,n){"use strict";e=e("@braintree/asset-loader/load-script"),t.exports={loadScript:e}},{"@braintree/asset-loader/load-script":3}],16:[function(e,t,n){"use strict";var r=e("./braintree-error"),i=e("./promise"),o=e("./errors");t.exports={verify:function(e){var t,n;return e?(n=e.name,t=e.client,e=e.authorization,t||e?e||"3.82.0"===t.getVersion()?i.resolve():i.reject(new r({type:o.INCOMPATIBLE_VERSIONS.type,code:o.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+t.getVersion()+") and "+n+" (version 3.82.0) components must be from the same SDK version."})):i.reject(new r({type:o.INSTANTIATION_OPTION_REQUIRED.type,code:o.INSTANTIATION_OPTION_REQUIRED.code,message:"options.client is required when instantiating "+n+"."}))):i.reject(new r({type:o.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:o.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:"Options must be passed to basicComponentVerification function."}))}}},{"./braintree-error":17,"./errors":24,"./promise":26}],17:[function(e,t,n){"use strict";function r(e){if(!r.types.hasOwnProperty(e.type))throw new Error(e.type+" is not a valid type.");if(!e.code)throw new Error("Error code required.");if(!e.message)throw new Error("Error message required.");this.name="BraintreeError",this.code=e.code,this.message=e.message,this.type=e.type,this.details=e.details}e=e("./enumerate"),((r.prototype=Object.create(Error.prototype)).constructor=r).types=e(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]),r.findRootError=function(e){return e instanceof r&&e.details&&e.details.originalError?r.findRootError(e.details.originalError):e},t.exports=r},{"./enumerate":23}],18:[function(e,t,n){"use strict";t.exports=function(n){return Object.keys(n).reduce(function(e,t){return e[t.replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1_$2").toLowerCase()]=n[t],e},{})}},{}],19:[function(e,t,n){"use strict";t.exports={ANALYTICS_PREFIX:"web.",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:{production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"},CLIENT_API_URLS:{production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"},FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",BUS_CONFIGURATION_REQUEST_EVENT:"BUS_CONFIGURATION_REQUEST",GRAPHQL_URLS:{production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"},INTEGRATION_TIMEOUT_MS:6e4,VERSION:"3.82.0",INTEGRATION:"custom",SOURCE:"client",PLATFORM:"web",BRAINTREE_LIBRARY_VERSION:"braintree/web/3.82.0"}},{}],20:[function(e,t,n){"use strict";var r=e("./braintree-error"),i=e("./errors");t.exports=function(t,e){e.forEach(function(e){t[e]=function(){throw new r({type:i.METHOD_CALLED_AFTER_TEARDOWN.type,code:i.METHOD_CALLED_AFTER_TEARDOWN.code,message:e+" cannot be called after teardown."})}})}},{"./braintree-error":17,"./errors":24}],21:[function(e,t,n){"use strict";var r=e("./constants").ASSETS_URLS;t.exports={create:function(e){return r.production}}},{"./constants":19}],22:[function(e,t,n){"use strict";var r=e("./braintree-error"),i=e("./promise"),o=e("./assets"),s=e("./errors"),a="3.82.0";t.exports={create:function(e){var t=i.resolve();return e.client?i.resolve(e.client):(t=window.braintree&&window.braintree.client?t:o.loadScript({src:e.assetsUrl+"/web/"+a+"/js/client.min.js"})["catch"](function(e){return i.reject(new r({type:s.CLIENT_SCRIPT_FAILED_TO_LOAD.type,code:s.CLIENT_SCRIPT_FAILED_TO_LOAD.code,message:s.CLIENT_SCRIPT_FAILED_TO_LOAD.message,details:{originalError:e}}))})).then(function(){return window.braintree.client.VERSION!==a?i.reject(new r({type:s.INCOMPATIBLE_VERSIONS.type,code:s.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+window.braintree.client.VERSION+") and "+e.name+" (version "+a+") components must be from the same SDK version."})):window.braintree.client.create({authorization:e.authorization,debug:e.debug})})}}},{"./assets":15,"./braintree-error":17,"./errors":24,"./promise":26}],23:[function(e,t,n){"use strict";t.exports=function(e,n){return n=null==n?"":n,e.reduce(function(e,t){return e[t]=n+t,e},{})}},{}],24:[function(e,t,n){"use strict";e=e("./braintree-error"),t.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:e.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:e.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:e.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:e.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:e.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"}}},{"./braintree-error":17}],25:[function(e,t,n){"use strict";t.exports=function(t){return Object.keys(t).filter(function(e){return"function"==typeof t[e]})}},{}],26:[function(e,t,n){"use strict";var r=e("promise-polyfill"),e=e("@braintree/extended-promise"),r="undefined"!=typeof Promise?Promise:r;e.suppressUnhandledPromiseMessage=!0,e.setPromise(r),t.exports=r},{"@braintree/extended-promise":4,"promise-polyfill":9}]},{},[12])(12)}),function(e){var t;"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).braintree||(t.braintree={})).googlePayment=e()}(function(){return function n(o,i,a){function s(t,e){if(!i[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=i[t]={exports:{}},o[t][0].call(r.exports,function(e){return s(o[t][1][e]||e)},r,r.exports,n,o,i,a)}return i[t].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(r,"__esModule",{value:!0}),r.PromiseGlobal=void 0,e=n(e("promise-polyfill")),e="undefined"!=typeof Promise?Promise:e["default"],r.PromiseGlobal=e},{"promise-polyfill":9}],2:[function(e,t,r){"use strict";var a=e("./lib/promise"),s={};function n(r){var e,t=JSON.stringify(r);if(!r.forceScriptReload&&(e=s[t]))return e;var n=document.createElement("script"),o=r.dataAttributes||{},i=r.container||document.head;return n.src=r.src,n.id=r.id||"",n["async"]=!0,r.crossorigin&&n.setAttribute("crossorigin",""+r.crossorigin),Object.keys(o).forEach(function(e){n.setAttribute("data-"+e,""+o[e])}),e=new a.PromiseGlobal(function(e,t){n.addEventListener("load",function(){e(n)}),n.addEventListener("error",function(){t(new Error(r.src+" failed to load."))}),n.addEventListener("abort",function(){t(new Error(r.src+" has aborted."))}),i.appendChild(n)}),s[t]=e}n.clearCache=function(){s={}},t.exports=n},{"./lib/promise":1}],3:[function(e,t,r){t.exports=e("./dist/load-script")},{"./dist/load-script":2}],4:[function(e,t,r){"use strict";var n="undefined"!=typeof Promise?Promise:null,n=(o.defaultOnResolve=function(e){return o.Promise.resolve(e)},o.defaultOnReject=function(e){return o.Promise.reject(e)},o.setPromise=function(e){o.Promise=e},o.shouldCatchExceptions=function(e){return e.hasOwnProperty("suppressUnhandledPromiseMessage")?Boolean(e.suppressUnhandledPromiseMessage):Boolean(o.suppressUnhandledPromiseMessage)},o.all=function(e){return o.Promise.all(e)},o.allSettled=function(e){return o.Promise.allSettled(e)},o.race=function(e){return o.Promise.race(e)},o.reject=function(e){return o.Promise.reject(e)},o.resolve=function(e){return o.Promise.resolve(e)},o.prototype.then=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this._promise).then.apply(e,t)},o.prototype["catch"]=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this._promise)["catch"].apply(e,t)},o.prototype.resolve=function(e){var t=this;return this.isFulfilled||(this._setResolved(),o.Promise.resolve().then(function(){return t._onResolve(e)}).then(function(e){t._resolveFunction(e)})["catch"](function(e){t._resetState(),t.reject(e)})),this},o.prototype.reject=function(e){var t=this;return this.isFulfilled||(this._setRejected(),o.Promise.resolve().then(function(){return t._onReject(e)}).then(function(e){t._setResolved(),t._resolveFunction(e)})["catch"](function(e){return t._rejectFunction(e)})),this},o.prototype._resetState=function(){this.isFulfilled=!1,this.isResolved=!1,this.isRejected=!1},o.prototype._setResolved=function(){this.isFulfilled=!0,this.isResolved=!0,this.isRejected=!1},o.prototype._setRejected=function(){this.isFulfilled=!0,this.isResolved=!1,this.isRejected=!0},o.Promise=n,o);function o(e){var r=this;"function"!=typeof e?(this._promise=new o.Promise(function(e,t){r._resolveFunction=e,r._rejectFunction=t}),this._onResolve=(e=e||{}).onResolve||o.defaultOnResolve,this._onReject=e.onReject||o.defaultOnReject,o.shouldCatchExceptions(e)&&this._promise["catch"](function(){}),this._resetState()):this._promise=new o.Promise(e)}t.exports=n},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deferred=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];setTimeout(function(){try{r.apply(void 0,e)}catch(e){console.log("Error in callback function"),console.log(e)}},1)}}},{}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.once=function(r){var n=!1;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n||(n=!0,r.apply(void 0,e))}}},{}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.promiseOrCallback=function(e,t){if(!t)return e;e.then(function(e){return t(null,e)})["catch"](function(e){return t(e)})}},{}],8:[function(e,t,r){"use strict";var o=e("./lib/deferred"),i=e("./lib/once"),a=e("./lib/promise-or-callback");function s(n){return function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return"function"==typeof t[t.length-1]&&(e=t.pop(),e=i.once(o.deferred(e))),a.promiseOrCallback(n.apply(this,t),e)}}s.wrapPrototype=function(n,e){var o=(e=void 0===e?{}:e).ignoreMethods||[],i=!0===e.transformPrivateMethods;return Object.getOwnPropertyNames(n.prototype).filter(function(e){var t="constructor"!==e&&"function"==typeof n.prototype[e],r=-1===o.indexOf(e),e=i||"_"!==e.charAt(0);return t&&e&&r}).forEach(function(e){var t=n.prototype[e];n.prototype[e]=s(t)}),n},t.exports=s},{"./lib/deferred":5,"./lib/once":6,"./lib/promise-or-callback":7}],9:[function(e,t,r){"use strict";var n=setTimeout;function c(e){return Boolean(e&&void 0!==e.length)}function o(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function a(r,n){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,i._immediateFn(function(){var e,t=1===r._state?n.onFulfilled:n.onRejected;if(null!==t){try{e=t(r._value)}catch(e){return void u(n.promise,e)}s(n.promise,e)}else(1===r._state?s:u)(n.promise,r._value)})):r._deferreds.push(n)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if(e instanceof i)return t._state=3,t._value=e,void l(t);if("function"==typeof r)return void f((n=r,o=e,function(){n.apply(o,arguments)}),t)}t._state=1,t._value=e,l(t)}catch(e){u(t,e)}var n,o}function u(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,r=e._deferreds.length;t<r;t++)a(e,e._deferreds[t]);e._deferreds=null}function p(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function f(e,t){var r=!1;try{e(function(e){r||(r=!0,s(t,e))},function(e){r||(r=!0,u(t,e))})}catch(e){if(r)return;r=!0,u(t,e)}}i.prototype["catch"]=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var r=new this.constructor(o);return a(this,new p(e,t,r)),r},i.prototype["finally"]=function(t){var r=this.constructor;return this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){return r.reject(e)})})},i.all=function(t){return new i(function(o,i){if(!c(t))return i(new TypeError("Promise.all accepts an array"));var a=Array.prototype.slice.call(t);if(0===a.length)return o([]);for(var s=a.length,e=0;e<a.length;e++)!function t(r,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){t(r,e)},i)}a[r]=e,0==--s&&o(a)}catch(e){i(e)}}(e,a[e])})},i.allSettled=function(r){return new this(function(o,e){if(!r||void 0===r.length)return e(new TypeError(typeof r+" "+r+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(r);if(0===i.length)return o([]);for(var a=i.length,t=0;t<i.length;t++)!function t(r,e){if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){t(r,e)},function(e){i[r]={status:"rejected",reason:e},0==--a&&o(i)})}i[r]={status:"fulfilled",value:e},0==--a&&o(i)}(t,i[t])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(r){return new i(function(e,t){t(r)})},i.race=function(o){return new i(function(e,t){if(!c(o))return t(new TypeError("Promise.race accepts an array"));for(var r=0,n=o.length;r<n;r++)i.resolve(o[r]).then(e,t)})},i._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t.exports=i},{}],10:[function(e,t,r){"use strict";e=e("../lib/braintree-error"),t.exports={GOOGLE_PAYMENT_NOT_ENABLED:{type:e.types.MERCHANT,code:"GOOGLE_PAYMENT_NOT_ENABLED",message:"Google Pay is not enabled for this merchant."},GOOGLE_PAYMENT_GATEWAY_ERROR:{code:"GOOGLE_PAYMENT_GATEWAY_ERROR",message:"There was an error when tokenizing the Google Pay payment method.",type:e.types.UNKNOWN},GOOGLE_PAYMENT_UNSUPPORTED_VERSION:{code:"GOOGLE_PAYMENT_UNSUPPORTED_VERSION",type:e.types.MERCHANT}}},{"../lib/braintree-error":18}],11:[function(e,t,r){"use strict";var i=e("../lib/analytics"),a=e("../lib/assign").assign,n=e("../lib/convert-methods-to-error"),s=e("../lib/find"),o=e("../lib/generate-google-pay-configuration"),c=e("../lib/braintree-error"),u=e("./errors"),l=e("../lib/methods"),p=e("../lib/promise"),e=e("@braintree/wrap-promise"),f={1:"_createV1PaymentDataRequest",2:"_createV2PaymentDataRequest"};function d(e){if(this._createPromise=e.createPromise,this._client=e.client,this._useDeferredClient=e.useDeferredClient,this._googlePayVersion=e.googlePayVersion||1,this._googleMerchantId=e.googleMerchantId,this._isUnsupportedGooglePayAPIVersion())throw new c({code:u.GOOGLE_PAYMENT_UNSUPPORTED_VERSION.code,message:"The Braintree SDK does not support Google Pay version "+this._googlePayVersion+". Please upgrade the version of your Braintree SDK and contact support if this error persists.",type:u.GOOGLE_PAYMENT_UNSUPPORTED_VERSION.type})}d.prototype._waitForClient=function(){return this._client?p.resolve():this._createPromise.then((function(e){this._client=e}).bind(this))},d.prototype._isUnsupportedGooglePayAPIVersion=function(){return!(this._googlePayVersion in f)},d.prototype._getDefaultConfig=function(){return this._defaultConfig||(this._defaultConfig=o(this._client.getConfiguration(),this._googlePayVersion,this._googleMerchantId)),this._defaultConfig},d.prototype._createV1PaymentDataRequest=function(e){var t=this._getDefaultConfig(),r=e.cardRequirements&&e.cardRequirements.allowedCardNetworks,n=t.cardRequirements.allowedCardNetworks,n=r||n;return(e=a({},t,e)).cardRequirements.allowedCardNetworks=n,e},d.prototype._createV2PaymentDataRequest=function(e){var o=this._getDefaultConfig();return e.allowedPaymentMethods&&e.allowedPaymentMethods.forEach(function(e){var t,r,n=s(o.allowedPaymentMethods,"type",e.type);n&&(t=e,r=n,Object.keys(r).forEach(function(e){"object"==typeof r[e]?t[e]=a({},r[e],t[e]):t[e]=t[e]||r[e]}))}),a({},o,e)},d.prototype.createPaymentDataRequest=function(e){return this._useDeferredClient?this._waitForClient().then((function(){return this._createPaymentDataRequestSyncronously(e)}).bind(this)):this._createPaymentDataRequestSyncronously(e)},d.prototype._createPaymentDataRequestSyncronously=function(e){var t=a({},e),r=this._googlePayVersion,e=f[r];return i.sendEvent(this._createPromise,"google-payment.v"+r+".createPaymentDataRequest"),this[e](t)},d.prototype.parseResponse=function(n){var o=this;return p.resolve().then(function(){var e,t=(2===n.apiVersion?n.paymentMethodData.tokenizationData:n.paymentMethodToken).token,r=JSON.parse(t);return(t=r.error)?p.reject(t):(i.sendEvent(o._createPromise,"google-payment.parseResponse.succeeded"),r.paypalAccounts?(e=r.paypalAccounts[0],i.sendEvent(o._createPromise,"google-payment.parseResponse.succeeded.paypal"),p.resolve({nonce:e.nonce,type:e.type,description:e.description})):(e=r.androidPayCards[0],i.sendEvent(o._createPromise,"google-payment.parseResponse.succeeded.google-payment"),p.resolve({nonce:e.nonce,type:e.type,description:e.description,details:{cardType:e.details.cardType,lastFour:e.details.lastFour,lastTwo:e.details.lastTwo,isNetworkTokenized:e.details.isNetworkTokenized,bin:e.details.bin},binData:e.binData})))})["catch"](function(e){return i.sendEvent(o._createPromise,"google-payment.parseResponse.failed"),p.reject(new c({code:u.GOOGLE_PAYMENT_GATEWAY_ERROR.code,message:u.GOOGLE_PAYMENT_GATEWAY_ERROR.message,type:u.GOOGLE_PAYMENT_GATEWAY_ERROR.type,details:{originalError:e}}))})},d.prototype.teardown=function(){return n(this,l(d.prototype)),p.resolve()},t.exports=e.wrapPrototype(d)},{"../lib/analytics":14,"../lib/assign":16,"../lib/braintree-error":18,"../lib/convert-methods-to-error":20,"../lib/find":26,"../lib/generate-google-pay-configuration":27,"../lib/methods":29,"../lib/promise":30,"./errors":10,"@braintree/wrap-promise":8}],12:[function(e,t,r){"use strict";var o=e("./google-payment"),i=e("../lib/braintree-error"),a=e("../lib/promise"),s=e("../lib/create-assets-url"),c=e("../lib/create-deferred-client"),u=e("../lib/basic-component-verification"),n=e("@braintree/wrap-promise"),l=e("./errors");t.exports={create:n(function(r){var n="Google Pay";return u.verify({name:n,client:r.client,authorization:r.authorization}).then(function(){var t,e=c.create({authorization:r.authorization,client:r.client,debug:r.debug,assetsUrl:s.create(r.authorization),name:n}).then(function(e){var t=e.getConfiguration();return r.client=e,t.gatewayConfiguration.androidPay?e:a.reject(new i(l.GOOGLE_PAYMENT_NOT_ENABLED))});return r.createPromise=e,t=new o(r),r.useDeferredClient?t:e.then(function(e){return t._client=e,t})})}),VERSION:"3.82.0"}},{"../lib/basic-component-verification":17,"../lib/braintree-error":18,"../lib/create-assets-url":21,"../lib/create-deferred-client":23,"../lib/promise":30,"./errors":10,"./google-payment":11,"@braintree/wrap-promise":8}],13:[function(e,t,r){"use strict";var i=e("./create-authorization-data"),a=e("./json-clone"),s=e("./constants");t.exports=function(e,t){var r,n=t?a(t):{},t=i(e.authorization).attrs,o=a(e.analyticsMetadata);for(r in n.braintreeLibraryVersion=s.BRAINTREE_LIBRARY_VERSION,n._meta)n._meta.hasOwnProperty(r)&&(o[r]=n._meta[r]);return n._meta=o,t.tokenizationKey?n.tokenizationKey=t.tokenizationKey:n.authorizationFingerprint=t.authorizationFingerprint,n}},{"./constants":19,"./create-authorization-data":22,"./json-clone":28}],14:[function(e,t,r){"use strict";var n=e("./promise"),s=e("./constants"),c=e("./add-metadata");t.exports={sendEvent:function(e,o,i){var a=Date.now();return n.resolve(e).then(function(e){var t=Date.now(),r=e.getConfiguration(),n=e._request,e=r.gatewayConfiguration.analytics.url,t={analytics:[{kind:s.ANALYTICS_PREFIX+o,isAsync:Math.floor(t/1e3)!==Math.floor(a/1e3),timestamp:a}]};n({url:e,method:"post",data:c(r,t),timeout:s.ANALYTICS_REQUEST_TIMEOUT_MS},i)})}}},{"./add-metadata":13,"./constants":19,"./promise":30}],15:[function(e,t,r){"use strict";e=e("@braintree/asset-loader/load-script"),t.exports={loadScript:e}},{"@braintree/asset-loader/load-script":3}],16:[function(e,t,r){"use strict";var n="function"==typeof Object.assign?Object.assign:o;function o(e){for(var t,r,n=1;n<arguments.length;n++)for(r in t=arguments[n])t.hasOwnProperty(r)&&(e[r]=t[r]);return e}t.exports={assign:n,_assign:o}},{}],17:[function(e,t,r){"use strict";var n=e("./braintree-error"),o=e("./promise"),i=e("./errors");t.exports={verify:function(e){var t,r;return e?(r=e.name,t=e.client,e=e.authorization,t||e?e||"3.82.0"===t.getVersion()?o.resolve():o.reject(new n({type:i.INCOMPATIBLE_VERSIONS.type,code:i.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+t.getVersion()+") and "+r+" (version 3.82.0) components must be from the same SDK version."})):o.reject(new n({type:i.INSTANTIATION_OPTION_REQUIRED.type,code:i.INSTANTIATION_OPTION_REQUIRED.code,message:"options.client is required when instantiating "+r+"."}))):o.reject(new n({type:i.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:i.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:"Options must be passed to basicComponentVerification function."}))}}},{"./braintree-error":18,"./errors":25,"./promise":30}],18:[function(e,t,r){"use strict";function n(e){if(!n.types.hasOwnProperty(e.type))throw new Error(e.type+" is not a valid type.");if(!e.code)throw new Error("Error code required.");if(!e.message)throw new Error("Error message required.");this.name="BraintreeError",this.code=e.code,this.message=e.message,this.type=e.type,this.details=e.details}e=e("./enumerate"),((n.prototype=Object.create(Error.prototype)).constructor=n).types=e(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]),n.findRootError=function(e){return e instanceof n&&e.details&&e.details.originalError?n.findRootError(e.details.originalError):e},t.exports=n},{"./enumerate":24}],19:[function(e,t,r){"use strict";t.exports={ANALYTICS_PREFIX:"web.",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:{production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"},CLIENT_API_URLS:{production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"},FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",BUS_CONFIGURATION_REQUEST_EVENT:"BUS_CONFIGURATION_REQUEST",GRAPHQL_URLS:{production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"},INTEGRATION_TIMEOUT_MS:6e4,VERSION:"3.82.0",INTEGRATION:"custom",SOURCE:"client",PLATFORM:"web",BRAINTREE_LIBRARY_VERSION:"braintree/web/3.82.0"}},{}],20:[function(e,t,r){"use strict";var n=e("./braintree-error"),o=e("./errors");t.exports=function(t,e){e.forEach(function(e){t[e]=function(){throw new n({type:o.METHOD_CALLED_AFTER_TEARDOWN.type,code:o.METHOD_CALLED_AFTER_TEARDOWN.code,message:e+" cannot be called after teardown."})}})}},{"./braintree-error":18,"./errors":25}],21:[function(e,t,r){"use strict";var n=e("./constants").ASSETS_URLS;t.exports={create:function(e){return n.production}}},{"./constants":19}],22:[function(e,t,r){"use strict";var o=e("../lib/vendor/polyfill").atob,i=e("../lib/constants").CLIENT_API_URLS;t.exports=function(e){var t,r,n={attrs:{},configUrl:""};return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(e)?(t=(r=(t=e).split("_"))[0],t={merchantId:r.slice(2).join("_"),environment:t},n.environment=t.environment,n.attrs.tokenizationKey=e,n.configUrl=i[t.environment]+"/merchants/"+t.merchantId+"/client_api/v1/configuration"):(e=JSON.parse(o(e)),n.environment=e.environment,n.attrs.authorizationFingerprint=e.authorizationFingerprint,n.configUrl=e.configUrl,n.graphQL=e.graphQL),n}},{"../lib/constants":19,"../lib/vendor/polyfill":31}],23:[function(e,t,r){"use strict";var n=e("./braintree-error"),o=e("./promise"),i=e("./assets"),a=e("./errors"),s="3.82.0";t.exports={create:function(e){var t=o.resolve();return e.client?o.resolve(e.client):(t=window.braintree&&window.braintree.client?t:i.loadScript({src:e.assetsUrl+"/web/"+s+"/js/client.min.js"})["catch"](function(e){return o.reject(new n({type:a.CLIENT_SCRIPT_FAILED_TO_LOAD.type,code:a.CLIENT_SCRIPT_FAILED_TO_LOAD.code,message:a.CLIENT_SCRIPT_FAILED_TO_LOAD.message,details:{originalError:e}}))})).then(function(){return window.braintree.client.VERSION!==s?o.reject(new n({type:a.INCOMPATIBLE_VERSIONS.type,code:a.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+window.braintree.client.VERSION+") and "+e.name+" (version "+s+") components must be from the same SDK version."})):window.braintree.client.create({authorization:e.authorization,debug:e.debug})})}}},{"./assets":15,"./braintree-error":18,"./errors":25,"./promise":30}],24:[function(e,t,r){"use strict";t.exports=function(e,r){return r=null==r?"":r,e.reduce(function(e,t){return e[t]=r+t,e},{})}},{}],25:[function(e,t,r){"use strict";e=e("./braintree-error"),t.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:e.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:e.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:e.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:e.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:e.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"}}},{"./braintree-error":18}],26:[function(e,t,r){"use strict";t.exports=function(e,t,r){for(var n=0;n<e.length;n++)if(e[n].hasOwnProperty(t)&&e[n][t]===r)return e[n];return null}},{}],27:[function(e,t,r){"use strict";var n=e("./assign").assign;function s(e,t){var r=e.analyticsMetadata,r={gateway:"braintree","braintree:merchantId":e.gatewayConfiguration.merchantId,"braintree:apiVersion":"v1","braintree:sdkVersion":"3.82.0","braintree:metadata":JSON.stringify({source:r.source,integration:r.integration,sessionId:r.sessionId,version:"3.82.0",platform:r.platform})};return n({},r,t)}t.exports=function(e,t,r){var n,o,i=e.gatewayConfiguration.androidPay,a="production"===e.gatewayConfiguration.environment?"PRODUCTION":"TEST";return 2===t?(n={apiVersion:2,apiVersionMinor:0,environment:a,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:i.supportedNetworks.map(function(e){return e.toUpperCase()})},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:s(e,{"braintree:authorizationFingerprint":i.googleAuthorizationFingerprint})}}]},r&&(n.merchantInfo={merchantId:r}),i.paypalClientId&&(o={type:"PAYPAL",parameters:{purchase_context:{purchase_units:[{payee:{client_id:i.paypalClientId},recurring_payment:!0}]}},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:s(e,{"braintree:paypalClientId":i.paypalClientId})}},n.allowedPaymentMethods.push(o))):(n={environment:a,allowedPaymentMethods:["CARD","TOKENIZED_CARD"],paymentMethodTokenizationParameters:{tokenizationType:"PAYMENT_GATEWAY",parameters:s(e,{"braintree:authorizationFingerprint":i.googleAuthorizationFingerprint})},cardRequirements:{allowedCardNetworks:i.supportedNetworks.map(function(e){return e.toUpperCase()})}},"TOKENIZATION_KEY"===e.authorizationType&&(n.paymentMethodTokenizationParameters.parameters["braintree:clientKey"]=e.authorization),r&&(n.merchantId=r),t&&(n.apiVersion=t)),n}},{"./assign":16}],28:[function(e,t,r){"use strict";t.exports=function(e){return JSON.parse(JSON.stringify(e))}},{}],29:[function(e,t,r){"use strict";t.exports=function(t){return Object.keys(t).filter(function(e){return"function"==typeof t[e]})}},{}],30:[function(e,t,r){"use strict";var n=e("promise-polyfill"),e=e("@braintree/extended-promise"),n="undefined"!=typeof Promise?Promise:n;e.suppressUnhandledPromiseMessage=!0,e.setPromise(n),t.exports=n},{"@braintree/extended-promise":4,"promise-polyfill":9}],31:[function(e,t,r){"use strict";var n="function"==typeof atob?atob:o;function o(e){var t,r,n,o,i,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";if(!new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$").test(e))throw new Error("Non base64 encoded input passed to window.atob polyfill");for(i=0;r=a.indexOf(e.charAt(i++)),t=(15&(n=a.indexOf(e.charAt(i++))))<<4|(o=a.indexOf(e.charAt(i++)))>>2&15,o=(3&o)<<6|63&a.indexOf(e.charAt(i++)),s+=String.fromCharCode((63&r)<<2|n>>4&3)+(t?String.fromCharCode(t):"")+(o?String.fromCharCode(o):""),i<e.length;);return s}t.exports={atob:function(e){return n.call(window,e)},_atob:o}},{}]},{},[12])(12)});var paypalLoadScript=function(t){"use strict";var e=setTimeout;function n(t){return Boolean(t&&void 0!==t.length)}function r(){}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(t,this)}function i(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn(function(){var r,n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){try{r=n(t._value)}catch(t){return void a(e.promise,t)}u(e.promise,r)}else(1===t._state?u:a)(e.promise,t._value)})):t._deferreds.push(e)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void s((r=n,i=e,function(){r.apply(i,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){a(t,e)}var r,i}function a(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function f(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function s(t,e){var n=!1;try{t(function(t){n||(n=!0,u(e,t))},function(t){n||(n=!0,a(e,t))})}catch(t){if(n)return;n=!0,a(e,t)}}function l(t){var e="https://www.paypal.com/sdk/js";t.sdkBaseURL&&(e=t.sdkBaseURL,delete t.sdkBaseURL);var i=function(t,e){var n="",r="";return Array.isArray(t)?1<t.length?(n="*",r=t.toString()):n=t.toString():"string"==typeof t&&0<t.length?n=t:"string"==typeof e&&0<e.length&&(n="*",r=e),{"merchant-id":n,"data-merchant-id":r}}(t["merchant-id"],t["data-merchant-id"]),r=Object.assign({},t,i),u=Object.keys(r).filter(function(t){return void 0!==r[t]&&null!==r[t]&&""!==r[t]}).reduce(function(t,e){var n=r[e].toString();return"data-"===e.substring(0,5)?t.dataAttributes[e]=n:t.queryParams[e]=n,t},{queryParams:{},dataAttributes:{}}),i=u.queryParams,u=u.dataAttributes;return{url:e+"?"+function(t){var e="";return Object.keys(t).forEach(function(n){0!==e.length&&(e+="&"),e+=n+"="+t[n]}),e}(i),dataAttributes:u}}function p(t,e){void 0===e&&(e={});var n=document.createElement("script");return n.src=t,Object.keys(e).forEach(function(t){n.setAttribute(t,e[t]),"data-csp-nonce"===t&&n.setAttribute("nonce",e["data-csp-nonce"])}),n}function y(t,e){m(t,e=void 0===e?v():e);var n=t.url,r=t.attributes;if("string"!=typeof n||0===n.length)throw new Error("Invalid url.");if(void 0!==r&&"object"!=typeof r)throw new Error("Expected attributes to be an object.");return new e(function(t,e){if("undefined"==typeof window)return t();!function(t){var r=t.onSuccess,o=t.onError,i=p(t.url,t.attributes);i.onerror=o,i.onload=r,document.head.insertBefore(i,document.head.firstElementChild)}({url:n,attributes:r,onSuccess:function(){return t()},onError:function(){return e(new Error('The script "'+n+'" failed to load.'))}})})}function v(){if("undefined"==typeof Promise)throw new Error("Promise is undefined. To resolve the issue, use a Promise polyfill.");return Promise}function w(t){return window[t]}function m(t,e){if("object"!=typeof t||null===t)throw new Error("Expected an options object.");if(void 0!==e&&"function"!=typeof e)throw new Error("Expected PromisePonyfill to be a function.")}return o.prototype["catch"]=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(r);return i(this,new f(t,e,n)),n},o.prototype["finally"]=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})},o.all=function(t){return new o(function(e,r){if(!n(t))return r(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(t);if(0===o.length)return e([]);var i=o.length;function u(t,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var a=n.then;if("function"==typeof a)return a.call(n,function(e){u(t,e)},r),0}o[t]=n,0==--i&&e(o)}catch(t){r(t)}}for(var a=0;a<o.length;a++)u(a,o[a])})},o.allSettled=function(t){return new this(function(e,n){if(!t||void 0===t.length)return n(new TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var o=r.length;for(var u=0;u<r.length;u++)!function i(t,n){if(n&&("object"==typeof n||"function"==typeof n)){var u=n.then;if("function"==typeof u)return u.call(n,function(e){i(t,e)},function(n){r[t]={status:"rejected",reason:n},0==--o&&e(r)}),0}r[t]={status:"fulfilled",value:n},0==--o&&e(r)}(u,r[u])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,r){if(!n(t))return r(new TypeError("Promise.race accepts an array"));for(var i=0,u=t.length;i<u;i++)o.resolve(t[i]).then(e,r)})},o._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){e(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},t.loadCustomScript=function(t){return y(t,o)},t.loadScript=function(t){return function(t,e){if(m(t,e=void 0===e?v():e),"undefined"==typeof window)return e.resolve(null);var r=(u=l(t)).url,o=u.dataAttributes,i=o["data-namespace"]||"paypal",u=w(i);return function(t,e){var n=document.querySelector('script[src="'+t+'"]');if(null!==n){var r=p(t,e),o=Object.assign({},n.dataset);if(delete o.uidAuto,Object.keys(o).length===Object.keys(r.dataset).length){var i=!0;return Object.keys(o).forEach(function(t){o[t]!==r.dataset[t]&&(i=!1)}),i&&n}}}(r,o)&&u?e.resolve(u):y({url:r,attributes:o},e).then(function(){var t=w(i);if(t)return t;throw new Error("The window."+i+" global variable is not available.")})}(t,o)},t.version="4.1.0",Object.defineProperty(t,"__esModule",{value:!0}),t}({});window.paypalLoadCustomScript=paypalLoadScript.loadCustomScript,window.paypalLoadScript=paypalLoadScript.loadScript;var PaymentScreenPay=function(container,settings_purchase){var pane,pane_content,page,footer,area_method,area_select,area_card,area_contact,radioboxes_method,radioboxes_payment,message_error,input_card_number,icon_card,input_card_expiry,input_card_cvv,cbox_remember,field_recaptcha,input_email,cbox_billing,field_billing,input_billing,but_submit,but_submit_label,but_submit_icon,but_paypal,but_gpay,icon_loading,total_cost_decimal,total_cost_formatted,logged_in,payment,bt_token,bt_version,bt_client,timeout_animation,header_title,but_close,screen_title,INSTANCE=new VSModule,CARD_FORMATS={_default:/(.{1,4})/g,amex:/(.{1,4})(.{1,6})?(.{1,5})?/,dinersclub:/(.{1,4})(.{1,6})?(.{1,4})?/},CARD_ICONS=["amex","dinersclub","discover","jcb","mastercard","visa"],REGEX_EMAIL=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,RESPONSE_CARD_ATTEMPTS="Declined after too many failed attempts",RESPONSE_CARD_DECLINED="Card declined",RESPONSE_CARD_FLAGGED="Card flagged as suspicious, please try another card",RESPONSE_CARD_NORESULT="Card failed to process, please try another card",RESPONSE_SAVED_CARD_BAD="Stored card invalid, please use another card",RESPONSE_EMAIL_INVALID="Enter a valid email",RESPONSE_NUMBER_INVALID="Invalid card number",RESPONSE_EXPIRY_INVALID="Invalid expiry date",RESPONSE_EXPIRY_EXPIRED="Card has expired",RESPONSE_CVV_INVALID="Invalid CVV number",RESPONSE_RECAPTCHA_FAILED="Recaptcha check failed",RESPONSE_PRIOR_PURCHASE="Please check your email history, this image appears to have already been purchased",ERROR_DETAILS={2044:{message:"Bank Declined Purchase: Call Issuer",description:"The card-issuing bank has declined this transaction. Contact your bank for more information."},2015:{message:"Bank Declined Purchase: Transaction Not Allowed",description:"Your bank is declining the transaction for unspecified reasons, possibly due to an issue with the card itself. Contact your bank for more information."},2019:{message:"Bank Declined Purchase: Invalid Transaction",description:"Your bank declined the transaction, typically because the card does not support this type of transaction. Contact your bank for more information."},91567:{message:"Card type is not accepted",description:"Our payment processor does not support this type of credit card. Please try another card or payment type (eg. PayPal)."}},PAYPAL_ID_SANDBOX="AVg2i2yKuVMcRBeHn23PVmd2Tutw4sIxoj18wULkCjkTFl1s88s-cGlLerCw-17SCvJYvcXdxf0MWpVJ",PAYPAL_ID_LIVE="ARH1aa5Q51rCj-dqN63uczoqdCCMJRCUCaA4rvZ1Aw0IJjvRyCuntoAC9p1Q2tGkSz7czFf5yDJvZZl-",URL_PAYPAL="https://www.paypal.com/sdk/js?client-id="+(VectorStock.isProduction()?PAYPAL_ID_LIVE:PAYPAL_ID_SANDBOX)+"&currency=USD",URL_GOOGLE_PAY="https://pay.google.com/gp/p/js/pay.js",URL_PAYPAL_SESSION="/api/loggedincheck",loaded_setup=null,loaded_setup_attempts=0,loaded_paypal=null,loaded_paypal_attempts=0,loaded_google_pay=null,loaded_google_pay_attempts=0,bt_device_data=null,form_input_fields=[],monitor_number=!1,monitor_expiry=!1,monitor_cvv=!1,monitor_email=!1,recaptcha_required=!1,recaptcha_id=null,recaptcha_value=null,payment_attempts={};function isSetupReady(){1==loaded_setup&&null!==loaded_paypal&&null!==loaded_google_pay&&function(){var but_close;radioboxes_method=new VectorStock.FieldRadioboxes($("ul.radiobuttons li",area_method)),radioboxes_payment=new VectorStock.FieldRadioboxes($("ul.radiobuttons li",area_select)),message_error=$(".message",area_card),but_close=$('input[name="card_number"]',area_card).payment("formatCardNumber"),input_card_number=new VectorStock.FieldInput(but_close),icon_card=$('fieldset[data-field="card_number"] .card',area_card),but_close=$('input[name="card_expiry"]',area_card).payment("formatCardExpiry"),input_card_expiry=new VectorStock.FieldInput(but_close),but_close=$('input[name="card_cvv"]',area_card).payment("formatCardCVC"),input_card_cvv=new VectorStock.FieldInput(but_close),field_recaptcha=$('.fieldgroup[data-id="recaptcha"]',area_card),cbox_remember=new VectorStock.FieldCheckbox($('input[name="remember_card"]',area_card)),input_email=new VectorStock.FieldInput($('input[name="email"]',area_contact)),cbox_billing=new VectorStock.FieldCheckbox($('input[name="inc_billing_address"]',area_contact)),field_billing=$('.fieldgroup[data-id="address"]',area_contact),input_billing=new VectorStock.FieldInput($('textarea[name="billing_address"]',field_billing)),form_input_fields=[input_card_number,input_card_expiry,input_card_cvv,input_email],but_submit=$("#pbox-creditcard",footer),but_submit_label=$(".label",but_submit),but_paypal=$("#paypal-button",footer),but_gpay=$("#gpay-button",footer),but_close=$('button[data-action="close"]',container),icon_loading&&icon_loading.remove();{function loadRecaptcha(){page.attr("data-recaptcha","show"),grecaptcha.ready(function(){recaptcha_id=grecaptcha.render($("#cc-recaptcha",field_recaptcha)[0],{sitekey:VectorStock.google_sitekey,callback:function(response){hideErrorCard()},"expired-callback":function(){},"error-callback":function(){}}),refreshHeight()})}(function(){{var log_detail;window.braintree&&bt_token?2==(bt_version=window.braintree.client?3:2)?(bt_client=new window.braintree.api.Client({clientToken:bt_token}),log_detail=braintree.data.setup({kount:{environment:VectorStock.isProduction()?"production":"sandbox"}}),bt_device_data=log_detail.deviceData):3==bt_version&&window.braintree.client.create({authorization:bt_token}).then(function(clientInstance){return bt_client=clientInstance,braintree.dataCollector.create({client:clientInstance,kount:!0}).then(function(dataCollectorInstance){bt_device_data=dataCollectorInstance.deviceData})})["catch"](function(err){try{VectorStock.log({source:"PaymentBox",issue:"Braintree token failed to authenticate",detail:{token:bt_token,error:{name:err.name,message:err.message}}})}catch(e){}}):(log_detail={braintree:window.braintree?"loaded":"unavailable",token:bt_token},VectorStock.log({source:"PaymentBox",issue:"Braintree object (or token) unavailable",detail:log_detail}))}})(),function(){function showPayPalUnavailable(){var message=$('<div class="err_missing">PayPal not available at this time</div>');but_paypal.empty().append(message)}{function formatResponse(response){return response.json()}function returnPaymentID(response){return response.id}var int_paypalsession,log_detail;window.paypal?but_paypal&&but_paypal.length&&(log_detail=window.paypal.Buttons({style:{label:"pay",layout:"horizontal",color:"gold",height:42,shape:"rect",tagline:!1},createOrder:function(data,actions){var url=generateAPIEndpoint("create","paypal"),params={email:input_email.value||null,address:cbox_billing.checked?input_billing.value:null};return settings_purchase.image&&(params.license=settings_purchase.image.license),settings_purchase.customization&&(params.asset_method=settings_purchase.image.payment||"existing"),int_paypalsession=setInterval(function(){$.get(URL_PAYPAL_SESSION)},6e5),fetch(url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(params)}).then(formatResponse).then(returnPaymentID)},onApprove:function(data,actions){int_paypalsession&&clearInterval(int_paypalsession),disableForm();var url=generateAPIEndpoint("validate","paypal",data.orderID);return fetch(url,{method:"POST"}).then(formatResponse).then(function(response){enableForm(),1==response.success?onPurchaseSuccess(response):response.message&&"DECLINED"===response.message?alert("PayPal has declined this transaction"):alert("Error: There was a problem connecting to your PayPal account")})},onError:function(err){if(int_paypalsession&&clearInterval(int_paypalsession),!err||!err.message||"Window navigated away"!=err.message){showPayPalUnavailable();try{VectorStock.log({source:"PaymentBox",issue:"PayPal threw an error during payment",detail:{error:{name:err.name,message:err.message}}})}catch(e){}}},onCancel:function(data,actions){int_paypalsession&&clearInterval(int_paypalsession)}}),VectorStock.loadJS.setPayPalButton(log_detail),log_detail.render(but_paypal[0])):(showPayPalUnavailable(),log_detail={paypal:window.paypal?"loaded":"unavailable"},VectorStock.log({source:"PaymentBox",issue:"PayPal object unavailable",detail:log_detail}))}}(),function(){{var gp_environment;window.google&&bt_token?(gp_environment=VectorStock.isProduction()?"PRODUCTION":"TEST",window.braintree.client.create({authorization:bt_token}).then(function(clientInstance){return braintree.googlePayment.create({client:clientInstance,googlePayVersion:2,googleMerchantId:VectorStock.google_merchant_id})}).then(function(googlePaymentInstance){var gp_client=new window.google.payments.api.PaymentsClient({environment:gp_environment,paymentDataCallbacks:{onPaymentAuthorized:function(paymentData){return new Promise(function(resolve,reject){googlePaymentInstance.parseResponse(paymentData,function(err,result){if(err)resolve({transactionState:"ERROR",error:{intent:"PAYMENT_AUTHORIZATION",message:"Payment failed - please check your card details.",reason:"PAYMENT_DATA_INVALID"}}),VectorStock.log({source:"PaymentBox",issue:"Google Pay payment failed within popup",detail:{error:err,result:result}});else{disableForm();var url=generateAPIEndpoint("create","braintree"),email_address=paymentData.email||null,params=null;try{params=paymentData.paymentMethodData.info.billingAddress}catch(err){}params={email:email_address,address:null,nonce:result.nonce,card:null,set_token:0,use_token:0,device_data:bt_device_data,billing_address:params};settings_purchase.image&&(params.license=settings_purchase.image.license),settings_purchase.customization&&(params.asset_method=settings_purchase.image.payment),$.post(url,params).done(function(response){enableForm(),1==response.success?(resolve({transactionState:"SUCCESS"}),onPurchaseSuccess(response)):(resolve({transactionState:"ERROR",error:{intent:"PAYMENT_AUTHORIZATION",message:response.error_message,reason:"PAYMENT_DATA_INVALID"}}),VectorStock.log({source:"PaymentBox",issue:"Google Pay failed to validate on VectorStock server",detail:{response:response,result:result}}))}).fail(function(event){enableForm(),VectorStock.log({source:"PaymentBox",issue:"Google Pay failed to connect to VectorStock server",detail:{event:event,result:result}}),alert("Error: There was a problem validating this payment")})}})})}}});gp_client.isReadyToPay({apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:googlePaymentInstance.createPaymentDataRequest().allowedPaymentMethods,existingPaymentMethodRequired:!0}).then(function(response){var log_detail;response.result?(log_detail=gp_client.createButton({buttonColor:"black",buttonType:"long",onClick:function(event){var paymentDataRequest=googlePaymentInstance.createPaymentDataRequest({transactionInfo:{countryCode:"US",currencyCode:"USD",totalPriceStatus:"FINAL",totalPrice:total_cost_formatted,totalPriceLabel:"Total"},merchantInfo:{merchantId:VectorStock.google_merchant_id,merchantName:"VectorStock"},emailRequired:!0});paymentDataRequest.callbackIntents=["PAYMENT_AUTHORIZATION"];var cardPaymentMethod=paymentDataRequest.allowedPaymentMethods[0];return cardPaymentMethod.parameters.billingAddressRequired=!0,cardPaymentMethod.parameters.billingAddressParameters={format:"FULL",phoneNumberRequired:!0},gp_client.loadPaymentData(paymentDataRequest).then(function(paymentData){googlePaymentInstance.parseResponse(paymentData,function(err,result){})})["catch"](function(err){VectorStock.log({source:"PaymentBox",issue:"Google Pay failed trying to load payment data",detail:{response:response,err:err}})})}}),but_gpay[0].appendChild(log_detail)):(showGooglePayUnavailable(),log_detail={google:window.google?"loaded":"unavailable",response:response,token:bt_token?"exists":"unavailable"},VectorStock.log({source:"PaymentBox",issue:"Google Pay failed trying to setup payment",detail:log_detail},"info"))})["catch"](function(err){showGooglePayUnavailable();var log_detail={google:window.google?"loaded":"unavailable",error:err};VectorStock.log({source:"PaymentBox",issue:"Google Pay failed trying to check if ready",detail:log_detail})})})["catch"](function(err){showGooglePayUnavailable();var log_detail={google:window.google?"loaded":"unavailable",token:bt_token?"exists":"unavailable",error:err};VectorStock.log({source:"PaymentBox",issue:"Google Pay failed trying to complete payment process",detail:log_detail})})):radioboxes_method.removeItem("gpay")}}(),recaptcha_required&&(window.grecaptcha?loadRecaptcha():(window.addEventListener("googleRecaptchaLoaded",function(){loadRecaptcha()}),VectorStock.loadJS.load("https://www.google.com/recaptcha/api.js?onload=onGoogleRecaptchaLoaded&render=explicit")))}radioboxes_method.on("change",onMethodSelect),radioboxes_payment.on("change",onPaymentSelect),input_card_number.on("change",onNumberUpdate),cbox_billing.on("change",toggleFieldAddress),but_submit.on("click",onSubmit),but_close.on("click",function(){INSTANCE.dispatchEvent("close")}),INSTANCE.show(),setTimeout(function(){input_card_number.focus()},200)}()}function showGooglePayUnavailable(){var message=$('<div class="err_missing">Google Pay not available at this time</div>');but_gpay.empty().append(message)}function addSavedCard(card_number,card_expiry){var item=$.payment.cardType(card_number);CARD_FORMATS[item]||CARD_FORMATS._default;CARD_FORMATS[item]?(label=card_number.match(CARD_FORMATS[item])).length&&(label.shift(),card_number=label.join(" ")):(label=card_number.match(CARD_FORMATS._default)).length&&(card_number=label.join(" ")),card_number=(card_number=card_number.replace(/(\.+[\.\s]+\.+)/,"<em>$1</em>")).replace(/\./g,"•");var item=$('<li class="checked" />'),label=$('<label for="pbox_payment_saved" />').appendTo(item);$('<input type="radio" id="pbox_payment_saved" name="pbox_payment" value="saved" checked="checked">').appendTo(label),$('<span class="title">Card: '+card_number+' <span class="expiry">Exp. '+card_expiry+"</span></span>").appendTo(label);item.prependTo($("ul.radiobuttons",area_select))}function refreshHeight(){pane_content.outerHeight()>pane.outerHeight()?pane.addClass("scrolling"):pane.removeClass("scrolling")}function generateAPIEndpoint(type,provider,order_id){return"create"==type?settings_purchase.image?settings_purchase.customization?"/api/invoice/"+provider+"/customization/"+settings_purchase.image.id:"/api/invoice/"+provider+"/single-image/"+settings_purchase.image.id:"/api/invoice/"+provider+"/cart":"reprocess"==type?"/api/invoice/dps/purchase":"validate"==type?"/api/invoice/validate/"+order_id:""}function onMethodSelect(method){page.attr("data-method",method),footer.attr("data-method",method)}function onPaymentSelect(type){page.attr("data-payment",type),refreshHeight(),type==PaymentScreenPay.CARD_ADDITIONAL&&(pane.scrollTop(pane_content.height()-pane.height()),input_card_number.focus())}function toggleFieldAddress(){var scroll_pos;cbox_billing.checked?(field_billing.show(),input_billing.focus()):field_billing.hide(),refreshHeight(),cbox_billing.checked&&(scroll_pos=field_billing.position().top+field_billing.height(),pane.scrollTop(scroll_pos))}function onNumberUpdate(number){function hideCardIcon(){input_card_cvv.input.attr("placeholder","CVV"),icon_card.removeClass("reveal"),setTimeout(function(){icon_card.attr("class","card")},200)}var type=$.payment.cardType(number);type?0<=CARD_ICONS.indexOf(type)?function(type){"amex"==type?input_card_cvv.input.attr("placeholder","CID"):input_card_cvv.input.attr("placeholder","CVV"),icon_card.attr("class","card reveal "+type)}(type):hideCardIcon():icon_card.hasClass("reveal")&&hideCardIcon()}function validateCardNumber(value){return $.payment.validateCardNumber(value)?(input_card_number.clearError(),!0):(showErrorCardNumber(RESPONSE_NUMBER_INVALID),!1)}function validateCardExpiry(value){var expiry=$.payment.cardExpiryVal(value);return $.payment.validateCardExpiry(expiry.month,expiry.year)?(input_card_expiry.clearError(),!0):(showErrorCardExpiry(RESPONSE_EXPIRY_INVALID),!1)}function validateCardCVV(value){var card_type=$.payment.cardType(input_card_number.value);return $.payment.validateCardCVC(value,card_type)?(input_card_cvv.clearError(),!0):(showErrorCardCVV(RESPONSE_CVV_INVALID),!1)}function validateEmail(value){return value.match(REGEX_EMAIL)?(input_email.clearError(),!0):(showErrorEmail(RESPONSE_EMAIL_INVALID),!1)}function showErrorCard(error_message,error_description){"card"==area_card.attr("data-error")?(message_error.removeClass("bounce"),timeout_animation&&clearTimeout(timeout_animation),setTimeout(function(){message_error.addClass("bounce"),timeout_animation=setTimeout(function(){message_error.removeClass("bounce")},1200)},20)):(area_card.attr("data-error","card"),message_error.empty(),message_error.append("<h6>"+error_message+"</h6>"),error_description&&message_error.append("<p>"+error_description+"</p>"),refreshHeight())}function hideErrorCard(){area_card.attr("data-error",""),message_error.empty(),refreshHeight()}function showErrorCardNumber(error){input_card_number.showError(error),monitor_number||(input_card_number.on("change",validateCardNumber),monitor_number=!0)}function showErrorCardExpiry(error){input_card_expiry.showError(error),monitor_expiry||(input_card_expiry.on("change",validateCardExpiry),monitor_expiry=!0)}function showErrorCardCVV(error){input_card_cvv.showError(error),monitor_cvv||(input_card_cvv.on("change",validateCardCVV),monitor_cvv=!0)}function showErrorEmail(error){input_email.showError(error),monitor_email||(input_email.on("change",validateEmail),monitor_email=!0)}function highlightFieldError(){for(var i=0;i<form_input_fields.length;i++)if(form_input_fields[i].hasError())return pane.scrollTop(form_input_fields[i].input.offset().top-pane_content.offset().top),form_input_fields[i].focus(),!0;return"card"==area_card.attr("data-error")}function generateRequestID(){var request={number:input_card_number.value,expiry_full:input_card_expiry.value,expiry:$.payment.cardExpiryVal(input_card_expiry.value),cvv:input_card_cvv.value,email:input_email.value};return recaptcha_required&&grecaptcha&&(request.recaptcha=grecaptcha.getResponse()),JSON.stringify(request).toLowerCase()}function maskCreditCardNumber(card_number){card_number=(card_number+"").replace(/\s+/g,"");var card_type=/(\d{4})(\d+)(\d{4})/g.exec(card_number);if(!card_type)return card_number;if((card_number=card_type[1]+"".padStart(card_type[2].length,"*")+card_type[3]).length<14)return card_number;var match,card_type=$.payment.cardType(card_number);CARD_FORMATS[card_type]||CARD_FORMATS._default;return CARD_FORMATS[card_type]?(match=card_number.match(CARD_FORMATS[card_type])).length&&(match.shift(),card_number=match.join(" ")):(match=card_number.match(CARD_FORMATS._default)).length&&(card_number=match.join(" ")),card_number}function onSubmit(event){var card,payment_data;if((radioboxes_payment.value||null)!==PaymentScreenPay.CARD_SAVED&&(card={number:input_card_number.value,expiry_full:input_card_expiry.value,expiry:$.payment.cardExpiryVal(input_card_expiry.value),cvv:input_card_cvv.value},payment_data=generateRequestID(),payment_attempts[payment_data]?(showPurchaseError(payment_attempts[payment_data].type,payment_attempts[payment_data].message),highlightFieldError(),log_detail={card:maskCreditCardNumber(card.number)},VectorStock.log({source:"PaymentBox",issue:"Credit Card form retry fail (client)",detail:log_detail})):(hideErrorCard(),validateCardNumber(card.number),validateCardExpiry(input_card_expiry.value),validateCardCVV(card.cvv,card.number),recaptcha_required&&function(){var log_detail,is_valid=0!==(recaptcha_value=grecaptcha?grecaptcha.getResponse():"").length;is_valid||(showErrorCard("Please tick the reCAPTCHA..."),log_detail={value:recaptcha_value,passed:!1},VectorStock.log({source:"PaymentBox",issue:"Failed to pass reCAPTCHA",detail:log_detail}))}(),logged_in||validateEmail(input_email.value))),highlightFieldError()){for(var log_detail={},log_error=!1,i=0;i<form_input_fields.length;i++)if(form_input_fields[i].hasError()){var name=form_input_fields[i].input.attr("name"),value=form_input_fields[i].value;"card"==name&&(value=maskCreditCardNumber(value)),log_detail[name]=value;try{!log_error&&value.length&&(log_error=!0)}catch(e){log_error=!0}}log_error&&VectorStock.log({source:"PaymentBox",issue:"Credit Card form invalid (client)",detail:log_detail})}else disableForm(),radioboxes_payment.value==PaymentScreenPay.CARD_SAVED?submitToBraintree():bt_client?2==bt_version?bt_client.tokenizeCard({number:card.number,expirationMonth:card.expiry.month,expirationYear:card.expiry.year,cvv:card.cvv},function(err,nonce){err?VectorStock.log({source:"PaymentBox",issue:"Braintree nonce could not be created (v2)",detail:{error:err}}):submitToBraintree(nonce,card,input_email.value)}):3==bt_version&&(payment_data={creditCard:{number:card.number,cvv:card.cvv,expirationDate:card.expiry_full,options:{validate:!1}}},bt_client.request({endpoint:"payment_methods/credit_cards",method:"post",data:payment_data},function(err,response){err?VectorStock.log({source:"PaymentBox",issue:"Braintree nonce could not be created (v3)",detail:{error:err}}):submitToBraintree(response.creditCards[0].nonce,card,input_email.value)})):function(card,email_address){var url=generateAPIEndpoint("create","dps"),params={card_number:card.number,card_month:card.expiry.month,card_year:card.expiry.year,card_cvv:card.cvv,email:email_address};submitToDPS(url,params)}(card,input_email.value);event.preventDefault()}function submitToBraintree(nonce,card,email_address){var url=generateAPIEndpoint("create","braintree"),params={email:email_address||null,address:cbox_billing.checked?input_billing.value:null,nonce:nonce||null,card:null,set_token:logged_in?Number(1==cbox_remember.checked):0,use_token:nonce?0:1,device_data:bt_device_data};null!==recaptcha_value&&(params.captcha=recaptcha_value),settings_purchase.image&&(params.license=settings_purchase.image.license),settings_purchase.customization&&(settings_purchase.license?params.asset_method=settings_purchase.image.payment:params.asset_method="existing"),$.post(url,params).done(function(response){var error_details;1==response.success?onPurchaseSuccess(response):0==response.attempts?showPurchaseError("attempts"):params.use_token?(area_select.remove(),page.attr("data-payment",PaymentScreenPay.CARD_ADDITIONAL),showPurchaseError("stored_card"),input_card_number.focus()):"processor"==response.error?function(card,transaction_id,failover_token){var params={id:transaction_id,card_number:card.number,card_month:card.expiry.month,card_year:card.expiry.year,card_cvv:card.cvv,failover_token:failover_token};submitToDPS("/api/invoice/dps/purchase",params)}(card,response.id,response.failover_token):response.code&&ERROR_DETAILS[response.code]?(error_details=ERROR_DETAILS[response.code],showPurchaseError(response.error,error_details.message,error_details.description)):showPurchaseError(response.error,response.message)}).fail(function(event){showPurchaseError()})}function submitToDPS(url,params){$.post(url,params,function(response){var error_details;VectorStock.log({source:"PaymentBox",issue:"DPS Process Outcome",detail:response}),1==response.success?onPurchaseSuccess(response):(error_details=ERROR_DETAILS[response.code])?showPurchaseError(response.error,error_details.message,error_details.description):showPurchaseError(response.error)})}function showPurchaseError(error_type,error_message,error_description){error_type=String(error_type).toLowerCase();var request_id=generateRequestID();switch(payment_attempts[request_id]||(payment_attempts[request_id]={type:error_type,message:error_message}),error_type){case"expiry":case"expire_month":case"expire_year":showErrorCardExpiry(RESPONSE_EXPIRY_INVALID);var log_detail={reason:"Expiry date invalid",card_expiry:input_card_expiry.value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"expired":showErrorCardExpiry(RESPONSE_EXPIRY_EXPIRED);log_detail={reason:"Card has expired",card_expiry:input_card_expiry.value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"cvv":showErrorCardCVV(RESPONSE_CVV_INVALID);log_detail={reason:"CVV invalid",card_cvv:input_card_cvv.value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"email":showErrorEmail(RESPONSE_EMAIL_INVALID);log_detail={reason:"Email invalid",email:input_email.value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"empty_cart":alert("Cart is Empty - Please contact support for more information");log_detail={reason:"Empty cart"};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"found_purchase":showErrorCard("Already Purchased",RESPONSE_PRIOR_PURCHASE);log_detail={reason:"Already purchased"};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"no result":showErrorCard(RESPONSE_CARD_NORESULT);log_detail={reason:"No result",card_number:maskCreditCardNumber(input_card_number.value)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"retry_token":showErrorCard(RESPONSE_CARD_NORESULT);log_detail={reason:"Retry Token Invalid",card_number:maskCreditCardNumber(input_card_number.value)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"recaptcha":showErrorCard(RESPONSE_RECAPTCHA_FAILED),null!==recaptcha_id&&grecaptcha.reset(recaptcha_id);log_detail={reason:"Recaptcha check failed",captcha:recaptcha_value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"invalid":case"number":showErrorCardNumber(RESPONSE_NUMBER_INVALID);log_detail={reason:"Card number invalid",card_number:input_card_number.value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"attempts":case"card_attempts":case"process_attempts":showErrorCard(RESPONSE_CARD_ATTEMPTS);log_detail={reason:"Too many card attempts",type:error_type};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"declined":showErrorCard(error_message||RESPONSE_CARD_DECLINED,error_description);log_detail={reason:"Card declined at server"};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"gateway_rejected":showErrorCard(RESPONSE_CARD_FLAGGED);log_detail={reason:"Card declined due to Braintree fraud protection",card_number:maskCreditCardNumber(input_card_number.value)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"stored_card":showErrorCard(RESPONSE_SAVED_CARD_BAD);log_detail={reason:"Card already stored",card_number:maskCreditCardNumber(input_card_number.value)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;default:showErrorCard(RESPONSE_CARD_DECLINED);log_detail={reason:"Untracked server error",type:error_type||"(Not set)",card_number:maskCreditCardNumber(input_card_number.value)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail})}enableForm()}function onPurchaseSuccess(response){VectorStock.trackPurchase(response.transaction.type,response.transaction.id,response.transaction.value,response.transaction.email,response.transaction.country,response.transaction.provider,response.transaction.txn_id),window.gtag&&gtag("event","conversion",{send_to:"AW-1056033416/zSYfCJKlw_cBEIiVx_cD",value:parseInt(response.transaction.value),currency:"USD",transaction_id:response.transaction.txn_id});var params=[response];settings_purchase.image&&params.push(settings_purchase.image.license),INSTANCE.dispatchEvent("purchase",params)}function disableForm(){container.addClass("disabled"),radioboxes_method.disable(),radioboxes_payment.disable(),input_email.disable().blur(),cbox_billing.disable(),input_billing.disable().blur(),input_card_number.disable().blur(),input_card_expiry.disable().blur(),input_card_cvv.disable().blur(),cbox_remember.disable(),field_recaptcha.addClass("disabled"),but_submit.prop("disabled",!0),but_submit_label.text("Processing…"),but_submit_icon=$(".icon",but_submit).loadingIcon()}function enableForm(){container.removeClass("disabled"),radioboxes_method.enable(),radioboxes_payment.enable(),input_email.enable(),cbox_billing.enable(),input_billing.enable(),input_card_number.enable(),input_card_expiry.enable(),input_card_cvv.enable(),cbox_remember.enable(),field_recaptcha.removeClass("disabled"),but_submit.prop("disabled",!1),but_submit_label.text("Pay Now"),but_submit_icon.remove()}function close(){INSTANCE.dispatchEvent("close")}return INSTANCE.show=function(){container.addClass("show")},INSTANCE.hide=function(){container.removeClass("show")},pane=$("> .panel .pane",container),pane_content=$("> div",pane),page=$("#pbox_details_card",container),header_title=$(".header h1",container),area_method=$("#pbox_payment_method_select",container),area_select=$("#pbox_payment_card_select",container),area_card=$("#pbox_payment_details",container),area_contact=$("#pbox_payment_new_contact",container),footer=$(".footer",container),but_close=$('button[data-action="close"]',container),total_cost_decimal=settings_purchase.total_cost===parseInt(settings_purchase.total_cost,10)?settings_purchase.total_cost:settings_purchase.total_cost.toFixed(2),total_cost_formatted=total_cost_decimal.formatCommas(),screen_title=settings_purchase.image?settings_purchase.customization?settings_purchase.image.payment===VectorOptions.PAYMENT_SINGLEIMAGE?"Image &amp; Customization":"Pay for Customization":settings_purchase.upgrade?"License Upgrade":"Image Purchase":"Cart Purchase",header_title.html(screen_title+" (<small>$</small><em>"+total_cost_formatted+"</em>)"),but_close.on("click",close),icon_loading=container.parent().loadingIcon("large"),function loadUserPaymentData(){$.ajax({url:"/api/purchases/setup"}).done(function(response){response.credits===undefined&&response.downloads===undefined?(logged_in=response.logged_in,response.user_id,payment=response.payment||null,bt_token=response.bt_token,recaptcha_required=response.recaptcha||!1,loaded_setup=!0,page.attr("data-account",1==logged_in?"member":"guest"),page.attr("data-payment",payment?"saved":"new"),response.payment&&addSavedCard(payment.card,payment.expiry),isSetupReady()):window.location.reload(!0)}).fail(function(){loaded_setup_attempts++<2?loadUserPaymentData():(VectorStock.log({source:"PaymentBox",issue:"Failed to load payments setup",detail:"URL: /api/purchases/setup"}),INSTANCE.dispatchEvent("close"),setTimeout(function(){alert("Server unavailable - please contact customer support")},5))})}(),function loadPayPalLibrary(){window.paypal&&window.paypal.Buttons?(loaded_paypal=!0,isSetupReady()):VectorStock.loadJS.loadPayPal("order",VectorStock.isProduction()?PAYPAL_ID_LIVE:PAYPAL_ID_SANDBOX,function(){loaded_paypal=!0,isSetupReady()},function(err){if(loaded_paypal_attempts++<2)loadPayPalLibrary();else{loaded_paypal=!1;try{VectorStock.log({source:"PaymentBox",issue:"Failed to load PayPal JS library",detail:{url:URL_PAYPAL,error:{name:err.name,message:err.message}}})}catch(e){}}})}(),function loadGooglePayLibrary(){window.google&&window.google.payments&&window.google.payments.api?(loaded_google_pay=!0,isSetupReady()):VectorStock.loadJS.load(URL_GOOGLE_PAY,function(){loaded_google_pay=!0,isSetupReady()},function(err){if(loaded_google_pay_attempts++<2)loadGooglePayLibrary();else{loaded_google_pay=!1;try{VectorStock.log({source:"PaymentBox",issue:"Failed to load Google Pay JS library",detail:{url:URL_GOOGLE_PAY,error:{name:err.name,message:err.message}}})}catch(e){}}})}(),INSTANCE};PaymentScreenPay.CARD_NEW="new",PaymentScreenPay.CARD_SAVED="saved",PaymentScreenPay.CARD_ADDITIONAL="additional";var PaymentScreenSuccess=function(screen,url_download,url_customization,next_step,image_license){var but_download,but_download_label,timeout_button,pane_content,but_next,but_next_label,but_return,INSTANCE=new VSModule,TIME_DISABLE_BUTTON=5*MS_MINUTE;function triggerDownload(){VectorStock.goToURL(url_download)}function disableDownloadLink(){but_download&&(but_download.prop("disabled",!0).addClass("expired"),but_download_label.html("Link has now expired..."),but_download.off("click",triggerDownload))}return INSTANCE.show=function(){screen.addClass("show")},INSTANCE.hide=function(){timeout_button&&clearTimeout(timeout_button),screen.removeClass("show")},url_customization==undefined?screen.attr("data-type","image").append('<div class="header"><h1>Payment Success!</h1></div><div class="panel"><div class="pane reveal"><div class="feature"><div class="notice"><p><span class="icon"></span>We have emailed you the invoice and download link</p></div><figure></figure><div class="base"><button type="button" data-action="download"><span class="icon"><span class="icon_download"></span></span><span class="label">Download again</span></button><button type="button" data-action="return"><span class="label">Return to page...</span></button></div></div></div></div>'):screen.attr("data-type","customization").append('<div class="header"><h1>Payment Success!</h1></div><div class="panel"><div class="pane reveal"><div class="feature"><div class="notice"><p><span class="icon"></span>We have emailed you the invoice and download link</p></div><figure></figure><div class="base"><p>Your designer is waiting to begin!</p><button type="button" data-action="next"><span class="label">Next Step - Create a design brief...</span></button></div></div></div></div>'),pane_content=$("> .panel .pane",screen),but_download=$('.feature button[data-action="download"]',pane_content),but_download_label=$("> .label",but_download),$("> .icon",but_download),but_next=$('.feature button[data-action="next"]',pane_content),but_next_label=$("> .label",but_next),but_return=$('.feature button[data-action="return"]',pane_content),$("> .label",but_download),but_close=$('button[data-action="close"]',screen),but_download.on("click",function(){VectorStock.isMobile()?INSTANCE.dispatchEvent("view_options"):triggerDownload()}),but_next.on("click",function(){VectorStock.goToURL(url_customization)}),but_return.on("click",function(event){event.preventDefault(),INSTANCE.dispatchEvent("close")}),but_close.on("click",function(event){INSTANCE.dispatchEvent("close")}),url_customization!==undefined?"signup"==next_step?but_next_label.html("Next Step - Create an account..."):"login"==next_step&&but_next_label.html("Next Step - Login to your account..."):url_download?VectorStock.isMobile()&&but_download_label.html("View download options..."):(but_download.remove(),VectorStock.isLoggedIn()&&$('<button type="button" data-action="download"><span class="label">View files for download...</span></button>').prependTo(".feature .base",pane_content).on("click",function(){VectorStock.goToURL("/transactions")})),but_download.length&&(timeout_button=setTimeout(disableDownloadLink,TIME_DISABLE_BUTTON)),INSTANCE.show(),url_download&&!VectorStock.isMobile()&&image_license&&triggerDownload(),INSTANCE},PaymentBox=function(settings_image,settings_purchase,settings_customization){var image,images,INSTANCE=new VSModule;$.isArray(settings_image)?images=settings_image:image=settings_image;var overlay,screen_pay,screen_success,imageset,timeout_session_expiry,image_snapshot,HTML_TEMPLATE='<div id="box-payment"><div class="pb-wrap"><div class="pb-sidebar"><div class="pb-screen"><div class="pb-content"><div class="imageset" data-images="1"></div><ul></ul></div><div class="pb-background"></div></div></div><div class="pb-screens"><div class="pb-screen" data-screen="pay"><div class="header"><h1></h1></div><div class="panel"><div class="pane reveal"><div id="pbox_details_card" data-account="" data-method="creditcard" data-payment=""><div id="pbox_payment_method_select" class="step"><h2><span class="point"></span><span class="title">Payment Method</span></h2><ul class="radiobuttons"><li class="checked"><label for="pbox_payment_method_creditcard"><input type="radio" id="pbox_payment_method_creditcard" name="pbox_payment_method" value="creditcard" checked="checked"><span class="title">Credit Card</span></label></li><li><label for="pbox_payment_method_paypal"><input type="radio" id="pbox_payment_method_paypal" name="pbox_payment_method" value="paypal"><span class="title">PayPal</span></label></li><li><label for="pbox_payment_method_gpay"><input type="radio" id="pbox_payment_method_gpay" name="pbox_payment_method" value="gpay"><span class="title">Google Pay</span></label></li></ul></div><div id="pbox_payment_card_select" class="step"><h2><span class="point"></span><span class="title">Select Card</span></h2><ul class="radiobuttons"><li><label for="pbox_payment_new"><input type="radio" id="pbox_payment_new" name="pbox_payment" value="additional"><span class="title">New credit card…</span></label></li></ul></div><div id="pbox_payment_details" class="step"><h2><span class="point"></span><span class="title">Payment Details</span></h2><div class="message"></div><div class="fieldgroup" data-id="card"><fieldset data-field="card_number"><span class="icon"></span><input type="tel" id="pbox_card_number" name="card_number" class="number" placeholder="Card Number" maxlength="19" autocomplete="cc-number"><span class="card"></span></fieldset></div><div class="fieldgroup" data-id="meta"><fieldset data-field="card_expiry"><span class="icon"></span><input type="tel" id="pbox_card_expiry" name="card_expiry" class="expiry" placeholder="MM / YY" maxlength="9" autocomplete="cc-exp"></fieldset><fieldset data-field="card_cvv"><span class="icon"></span><input type="tel" id="pbox_card_cvv" name="card_cvv" placeholder="CVV" maxlength="4" autocomplete="off"></fieldset><label for="pbox_remember_card" class="checkbox checked"><span class="box"><input type="checkbox" id="pbox_remember_card" name="remember_card" checked="checked" value="1"></span><span class="title">Remember</span></label></div><div class="fieldgroup" data-id="recaptcha"><div id="cc-recaptcha"></div></div></div><div id="pbox_payment_new_contact" class="step"><h2><span class="point"></span><span class="title">Contact</span></h2><div class="fieldgroup" data-id="email"><fieldset data-field="email"><span class="icon"></span><input type="email" name="email" maxlength="100" autocomplete="email" autocorrect="off" autocapitalize="off" placeholder="Email address"></fieldset></div><label for="pbox_inc_billing_address" class="checkbox"><span class="box"><input type="checkbox" id="pbox_inc_billing_address" name="inc_billing_address" value="1"></span><span class="title">Add Billing address to invoice</span></label><div class="fieldgroup" data-id="address"><fieldset data-field="address"><textarea id="pbox_billing_address" name="billing_address" placeholder="Billing address"></textarea></fieldset></div></div></div></div></div><div class="footer" data-method="creditcard"><button type="submit" id="pbox-creditcard"><span class="label">Buy &amp; Download</span><span class="icon"><span></button><div id="paypal-button"></div><div id="gpay-button"></div></div><button data-action="close" type="button">Close</button></div><div class="pb-screen" data-screen="success"><button data-action="close" type="button">Close</button></div></div></div></div>',HTML_BANNER='<div class="pb-banner"><button type="button"><span class="label">You can also <strong>buy with Credits</strong> for <strong>$1 per image...</strong></span><span class="icon"></span></button></div>';function addImage(image_id,image_title){var figure=$("<figure />").appendTo(imageset);$('<img width="238" height="250">').attr("src",VectorStock.imagePath(image_id,image_title,"medium")).attr("alt",image_title||"").appendTo(figure);$('<span class="inner" />').appendTo(figure)}function onClickOverlay(event){$(event.target)[0]==overlay[0]&&INSTANCE.close()}function onPurchase(transaction_response,image_license){screen_pay.hide();var url_customization,next_step,url_download=transaction_response.url;"zip"!==settings_purchase.filetype&&transaction_response.file_urls&&transaction_response.file_urls[settings_purchase.filetype]&&(url_download=transaction_response.file_urls[settings_purchase.filetype]),settings_customization&&transaction_response.customization&&(url_customization=transaction_response.customization.url,next_step=transaction_response.customization.status),(screen_success=new PaymentScreenSuccess($('.pb-screen[data-screen="success"]',screens),url_download,url_customization,next_step,image_license)).on("view_options",function(){INSTANCE.dispatchEvent("view_options"),INSTANCE.close()}),screen_success.on("close",function(){INSTANCE.close()}),images?EventTracker.track(EventTrackerLogger.ID_LOG,{source:"Cart Popup",event:"Purchased"}):EventTracker.track(EventTrackerLogger.ID_LOG,{source:"Purchase Popup",event:"Purchased"}),INSTANCE.dispatchEvent("purchase",[transaction_response,image_license,settings_purchase.total_cost])}return INSTANCE.close=function(){container&&container.remove(),overlay.remove(),clearTimeout(timeout_session_expiry),INSTANCE.dispatchEvent("close")},overlay=$('<div class="overlay" />').css({height:$(document).height()}).appendTo("body").on("click",onClickOverlay),setTimeout(function(){overlay.addClass("reveal")}),function(){var sidebar_points,banner,total_cost_formatted=settings_purchase.total_cost;"string"!=typeof total_cost_formatted&&(total_cost_formatted=(total_cost_formatted=total_cost_formatted.toFixed(2)).formatCommas());if(container=$(HTML_TEMPLATE).appendTo(overlay),license_cost_formatted=$(".pb-sidebar",container),sidebar_points=$(".pb-screen",license_cost_formatted).show(),license_cost_formatted=$(".pb-content",sidebar_points),sidebar_points=$("ul",license_cost_formatted),screens=$(".pb-screens",container),images){var customization_cost_formatted=Math.min(5,images.length);imageset=$(".imageset",license_cost_formatted).attr("data-images",customization_cost_formatted);for(var i=customization_cost_formatted;i--;)addImage(images[i]);var sb_html='<li><span class="dt">Total Cost</span><span class="dm"></span><span class="dd"><small>$</small><em>'+total_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>';sidebar_points.html(sb_html)}else{var license_cost_formatted;imageset=$(".imageset",license_cost_formatted).attr("data-images",1),addImage(image.id,image.title),settings_customization?image.license?(customization_cost_formatted=(customization_cost_formatted=settings_customization.cost.toFixed(2)).formatCommas(),image.payment===VectorOptions.PAYMENT_CREDITS?(sb_html='<li><span class="dt">'+image.license.toTitleCase()+' License</span><span class="dm"></span><span class="dd"><em>'+image.cost+'</em> <abbr title="VectorStock Credits">CR</abbr></span></li>',sb_html+='<li><span class="dt">Image Customization</span><span class="dm"></span><span class="dd"><small>$</small><em>'+customization_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>'):image.payment===VectorOptions.PAYMENT_SUBSCRIPTION?(sb_html='<li><span class="dt">'+image.license.toTitleCase()+' License</span><span class="dm"></span><span class="dd"><em>'+image.cost+'</em> <abbr title="Subscription Download">DL</abbr></span></li>',sb_html+='<li><span class="dt">Image Customization</span><span class="dm"></span><span class="dd"><small>$</small><em>'+customization_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>'):(license_cost_formatted=(license_cost_formatted=image.cost.toFixed(2)).formatCommas(),sb_html='<li><span class="dt">'+image.license.toTitleCase()+' License</span><span class="dm"></span><span class="dd"><small>$</small><em>'+license_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>',sb_html+='<li><span class="dt">Image Customization</span><span class="dm"></span><span class="dd"><small>$</small><em>'+customization_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>',sb_html+='<li class="total"><span class="dt">Total Cost</span><span class="dm"></span><span class="dd"><small>$</small><em>'+total_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>')):sb_html='<li><span class="dt">Image Customization</span><span class="dm"></span><span class="dd"><small>$</small><em>'+total_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>':(sb_html='<li><span class="dt">License</span><span class="dm"></span><span class="dd">'+image.license+"</span></li>",sb_html+='<li><span class="dt">Cost</span><span class="dm"></span><span class="dd"><small>$</small><em>'+total_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>'),sidebar_points.html(sb_html)}screen_pay=new PaymentScreenPay($('.pb-screen[data-screen="pay"]',screens),images?{total_cost:settings_purchase.total_cost}:{image:image,customization:settings_customization,total_cost:settings_purchase.total_cost,upgrade:settings_purchase.upgrade});settings_customization||(container.addClass("upsell").append(HTML_BANNER),banner=$(".pb-banner button",container));screen_pay.on("purchase",onPurchase),screen_pay.on("close",INSTANCE.close),settings_purchase.upgrade?banner.parent().remove():banner&&banner.on("click",function(event){var min_cost;VectorStock.isLoggedIn()?(min_cost=Math.max(30,5*Math.ceil(Math.round(settings_purchase.total_cost)/5)),images?VectorStock.goToURL("/purchase/credits/"+min_cost):VectorStock.goToURL("/purchase/credits/"+min_cost+"?id="+image.id)):(INSTANCE.close(),VectorStock.goToURL("/signup"))});$(window).height()<container.height()&&$(window).scrollTop(container.position().top);setTimeout(function(){container.addClass("reveal")})}(),VectorStock.isLoggedIn()&&(timeout_session_expiry=setTimeout(SignupBox.extendSession,SignupBox.TIME_EXPIRE)),images?(image_snapshot={cart_tally:settings_purchase.total_images,cart_value:settings_purchase.total_cost},EventTracker.track(EventTrackerLogger.ID_LOG,{source:"Cart Popup",event:"Initiated",cart:image_snapshot})):(image_snapshot={id:image.id,value:settings_purchase.total_cost},EventTracker.track(EventTrackerLogger.ID_LOG,{source:"Purchase Popup",event:"Initiated",image:image_snapshot},!0)),INSTANCE};